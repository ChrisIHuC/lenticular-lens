(function(t){function e(e){for(var i,a,n=e[0],l=e[1],c=e[2],u=0,p=[];u<n.length;u++)a=n[u],o[a]&&p.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],i=!0,n=1;n<s.length;n++){var l=s[n];0!==o[l]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=s[0]))}return t}var i={},o={app:0},r=[];function a(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=i,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/static/core/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;r.push(["56d7","chunk-vendors"]),s()})({"13be":function(t,e,s){"use strict";var i=s("e722"),o=s.n(i);o.a},"249d":function(t,e,s){},"2f61":function(t,e,s){"use strict";var i=s("e422"),o=s.n(i);o.a},"46ab":function(t,e,s){"use strict";var i=s("bd33"),o=s.n(i);o.a},"4ba3":function(t,e,s){"use strict";var i=s("249d"),o=s.n(i);o.a},"56d7":function(t,e,s){"use strict";s.r(e);var i=s("2b0e"),o=s("5f5b"),r=s("2ee4"),a=s.n(r),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.editing||""===t.value?s("div",{staticClass:"form-group col-auto"},[s("input",{ref:"editInput",staticClass:"form-control border-0",attrs:{type:"text",required:t.required},domProps:{value:t.value},on:{blur:function(e){t.editing=!1},input:function(e){return t.$emit("input",e.target.value)}}})]):s("div",{staticClass:"row",on:{mouseenter:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[s("div",{staticClass:"h2 col"},[t._v(t._s(t.value))]),s("button",{staticClass:"btn col-auto pl-0 pt-0",attrs:{type:"button",title:"Click to Edit"}},[s("octicon",{class:t.hideClass,attrs:{name:"pencil",scale:"1.2"},nativeOn:{click:function(e){e.stopPropagation(),e.preventDefault(),t.editing=!0}}})],1)])},l=[],c={name:"EditLabel",data(){return{editing:!1,hovering:!1}},props:{value:String,required:Boolean},computed:{hideClass(){return this.hovering?"":" invisible"}},updated(){this.editing&&this.$refs.editInput.focus()}},d=c,u=(s("4ba3"),s("2877")),p=Object(u["a"])(d,n,l,!1,null,"0b588d34",null),h=p.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{ref:"button",class:"btn btn-outline-info rounded-circle"+(t.scale<1?" pt-1 pb-1":""),attrs:{type:"button",title:t.title},on:{click:t.handleBtnClick}},[s("octicon",{attrs:{name:"plus",scale:t.scale}})],1)},v=[],_={methods:{handleBtnClick(){this.$refs["button"].blur(),this.$emit("click")}},props:{scale:{type:[Number,String],default:1},title:String}},f=_,g=Object(u["a"])(f,m,v,!1,null,null,null),b=g.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{ref:"button",staticClass:"btn text-danger",attrs:{type:"button",title:t.title},on:{click:t.handleBtnClick}},[s("octicon",{attrs:{name:"trashcan",scale:t.scale}})],1)},C=[],w={methods:{handleBtnClick(){this.$refs["button"].blur(),this.$emit("click")}},props:{scale:{type:[Number,String],default:2},title:String}},x=w,$=Object(u["a"])(x,y,C,!1,null,null,null),k=$.exports,j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"btn-info-popup"},[s("a",{staticClass:"btn btn-block text-info pt-1",on:{click:function(e){t.$refs["info_"+t.uuid].show()}}},[s("octicon",{attrs:{name:"question",scale:t.scale}})],1),s("b-modal",{ref:"info_"+t.uuid,staticClass:"text-center",attrs:{id:"info_"+t.uuid,title:t.popup_title,size:t.popup_size,scrollable:"","hide-footer":"","return-focus":t.$root.$children[0].$el}},[t._t("default")],2)],1)},I=[];let S=0;var O={beforeCreate(){this.uuid=S.toString(),S++},props:{popup_size:{type:String,default:"xl"},popup_title:String,scale:{type:Number,default:1.5}}},R=O,A=(s("46ab"),Object(u["a"])(R,j,I,!1,null,null,null)),M=A.exports,P=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("select",t._g(t._b({staticClass:"border-0 btn-outline-info form-control h-auto shadow",domProps:{value:t.value}},"select",t.$attrs,!1),t.inputListeners),[t._t("default")],2)},E=[],T={inheritAttrs:!1,props:["value"],computed:{inputListeners:function(){let t=this;return Object.assign({},this.$listeners,{input:function(e){e.target.blur(),t.$emit("input",e.target.value)}})}}},N=T,F=Object(u["a"])(N,P,E,!1,null,null,null),L=F.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row pl-3 align-items-center"},[t._l(t.property.length,function(e,i){return i%2===0?s("property-component",{ref:"propertyComponents",refInFor:!0,attrs:{value:t.property.slice(i,i+2),resources:t.getResourcesForIndex(i),properties:0===i?t.dataset[t.resource.collection_id]:t.dataset[t.property[i]],"read-only":t.readOnly,small:t.small,singular:t.singular,"singular-resource-info":t.singularResourceInfo,"follow-referenced-collection":t.followReferencedCollection},on:{input:function(e){return t.updateProperty(e,i)},reset:function(e){return t.$emit("resetProperty",i+e)},delete:function(e){return t.$emit("delete")},clone:function(e){return t.$emit("clone")}}}):t._e()}),t.values&&t.values.length>0?[s("div",{staticClass:"col-auto ml-2 p-1"},[s("octicon",{attrs:{name:"arrow-left"}}),s("octicon",{attrs:{name:"arrow-right"}})],1),t._l(t.values,function(e){return s("div",{staticClass:"col-auto btn border border-info bg-white text-info rounded-pill mx-2 my-1 py-0",class:t.small?"btn-sm":{}},[t._v("\n      "+t._s(e)+"\n    ")])})]:t._e()],2)},B=[],G=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row align-items-center"},[t.showReferencedPropertyButton?s("div",{staticClass:"col-auto p-1"},[s("octicon",{attrs:{name:"arrow-right"}})],1):t._e(),t.selectReferencedCollection||t.showResourceInfo||t.showReferencedPropertyButton?s("div",{staticClass:"col-auto"},[t.selectReferencedCollection?s("div",{staticClass:"row align-items-center"},[s("v-select",{staticClass:"my-1",class:{"is-invalid":t.errors.includes("value"),"form-control-sm":t.small},attrs:{value:t.value[0]},on:{input:function(e){return t.updateInput(e,0)}}},[Array.isArray(t.resources)?t._l(t.resources,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.label)+"\n            ")])}):[s("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("Choose a referenced collection")]),s("option",{attrs:{value:"__value__"}},[t._v("Value (do not follow reference)")]),t._l(Object.keys(t.resources),function(e){return s("option",{key:e,domProps:{value:e}},[t._v("\n              "+t._s(e)+"\n            ")])})]],2)],1):t.showResourceInfo?s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto btn border border-info bg-white rounded-pill my-1 py-0",class:t.small?"btn-sm":{}},[t._v("\n          "+t._s(t.$root.datasets[t.$root.getResourceById(t.value[0],t.resources).dataset_id].title)+"\n        ")]),s("div",{staticClass:"col-auto btn border border-info bg-white rounded-pill mx-2 my-1 py-0",class:t.small?"btn-sm":{}},[t._v("\n          "+t._s(t.$root.getResourceById(t.value[0],t.resources).collection_id)+"\n        ")]),t.singular||t.readOnly?t._e():s("div",{staticClass:"col-auto ml-0 pl-0"},[s("button-add",{attrs:{scale:.8,title:"Add another property for this Collection"},on:{click:function(e){return t.$emit("clone")}}}),s("button-delete",{attrs:{scale:"1.3",title:"Remove this property"},on:{click:function(e){return t.$emit("delete")}}})],1)]):t.showReferencedPropertyButton?s("div",{staticClass:"row align-items-center"},[t.readOnly?s("div",{staticClass:"col-auto btn bg-info text-white rounded-pill my-1 py-0",class:t.small?"btn-sm":{}},[t._v("\n          "+t._s(t.value[0])+"\n        ")]):s("button",{staticClass:"col-auto btn btn-info rounded-pill my-1 py-0",class:t.small?"btn-sm":{},attrs:{type:"button"},on:{click:function(e){t.readOnly||t.$emit("reset",0)}}},[t._v("\n          "+t._s(t.value[0])+"\n        ")])]):t._e()]):t._e(),""!==t.value[0]&&"__value__"!==t.value[0]?[Array.isArray(t.resources)?t._e():s("div",{staticClass:"col-auto p-1"},[s("octicon",{attrs:{name:"arrow-right"}})],1),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row align-items-center"},[t.value[1]||t.readOnly?t.readOnly?s("div",{staticClass:"col-auto btn bg-info text-white rounded-pill my-1 py-0",class:t.small?"btn-sm":{}},[t._v("\n            "+t._s(t.value[1])+"\n          ")]):s("button",{staticClass:"col-auto btn btn-info rounded-pill my-1 py-0",class:t.small?"btn-sm":{},attrs:{type:"button"},on:{click:function(e){t.readOnly||t.$emit("reset",1)}}},[t._v("\n            "+t._s(t.value[1])+"\n          ")]):[s("v-select",{staticClass:"col-auto my-1",class:{"is-invalid":t.errors.includes("value"),"form-control-sm":t.small},attrs:{value:t.value[1]},on:{input:function(e){return t.updateInput(e,1)}}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Choose a property")]),t._l(Object.keys(t.properties),function(e){return s("option",{domProps:{value:e}},[t._v(t._s(e)+"\n              ")])})],2)]],2)])]:t._e()],2)])},V=[],z={data(){return{errors:[]}},methods:{validateField(t,e){return e?this.removeError(t):this.addError(t),!!e},addError(t){this.errors.includes(t)||this.errors.push(t)},removeError(t){const e=this.errors.indexOf(t);e>=0&&this.errors.splice(e,1)}}},J={name:"propertyComponent",mixins:[z],props:{properties:Object,resources:[Array,Object],readOnly:{type:Boolean,default:!1},small:{type:Boolean,default:!1},singular:{type:Boolean,default:!1},singularResourceInfo:{type:Boolean,default:!1},followReferencedCollection:{type:Boolean,default:!0},value:Array},computed:{selectReferencedCollection(){return""===this.value[0]&&!this.readOnly},showResourceInfo(){return Array.isArray(this.resources)&&(!this.singular||this.singularResourceInfo||this.readOnly)},showReferencedPropertyButton(){return!Array.isArray(this.resources)&&(this.followReferencedCollection||this.readOnly||"__value__"!==this.value[0])}},methods:{validatePropertyComponent(){return this.validateField("value","__value__"===this.value[0]||void 0===this.value.find(t=>""===t))},updateInput(t,e){this.$emit("input",[e,t])}}},U=J,H=Object(u["a"])(U,G,V,!1,null,null,null),W=H.exports,q={name:"Property",components:{PropertyComponent:W},props:{property:Array,values:Array,readOnly:{type:Boolean,default:!1},small:{type:Boolean,default:!1},singular:{type:Boolean,default:!1},singularResourceInfo:{type:Boolean,default:!1},followReferencedCollection:{type:Boolean,default:!0}},computed:{resource(){return this.$root.getResourceById(this.property[0])},dataset(){return this.$root.datasets[this.resource.dataset_id].collections}},methods:{validateProperty(){return!this.$refs.propertyComponents.map(t=>t.validatePropertyComponent()).includes(!1)},getResourcesForIndex(t){if(0===t)return this.$root.resources;let e=t>2?this.property[t-2]:this.resource.collection_id;return this.dataset[e][this.property[t-1]]["referencedCollections"]},updateProperty(t,e){this.$set(this.property,e+t[0],t[1]);const s=this.property.length>2?this.property.slice(-2)[0]:this.resource.collection_id,i=this.$utilities.getOrCreate(this.$set,this.dataset[s][this.property.slice(-1)[0]],"referencedCollections",[]);this.property.slice(-1)[0]&&Object.keys(i).length>0&&(this.followReferencedCollection?this.property.push("",""):this.property.push("__value__",""))}}},Y=q,X=Object(u["a"])(Y,D,B,!1,null,null,null),Z=X.exports,K=s("8ab8"),Q=(s("886f"),s("6821")),tt=s.n(Q),et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"app"}},[s("form-wizard",{ref:"formWizard",attrs:{title:"Lenticular Lenses II",subtitle:"Reconcile data for Golden Agents",color:"#efc501",shape:"square"},scopedSlots:t._u([{key:"next",fn:function(e){return 0===e.activeTabIndex&&!t.job_id||[1,2].includes(e.activeTabIndex)?[0!==e.activeTabIndex||t.job_id?t._e():[s("wizard-button",{style:e.fillButtonStyle,attrs:{disabled:e.loading||"existing"===t.idea_form},nativeOn:{click:function(e){e.preventDefault(),e.stopPropagation(),t.idea_form="existing"}}},[t._v("\n          Existing Idea\n        ")]),t._v("\n         \n        "),t.hasChanges?s("wizard-button",{style:e.fillButtonStyle,attrs:{disabled:e.loading||"new"===t.idea_form},nativeOn:{click:function(e){e.preventDefault(),e.stopPropagation(),t.idea_form="new"}}},[t._v("\n          New Idea\n        ")]):t._e()],[1,2].includes(e.activeTabIndex)?[t.hasChanges?s("wizard-button",{style:e.fillButtonStyle,attrs:{disabled:e.loading},nativeOn:{click:function(s){return s.stopPropagation(),t.validateAndSave(e.activeTabIndex)}}},[t._v("\n          Save\n        ")]):t._e(),s("wizard-button",{style:e.fillButtonStyle,attrs:{disabled:e.loading}},[t._v("\n          Save and next\n        ")])]:t._e()]:void 0}},{key:"finish",fn:function(e){return[t._v("​")]}}],null,!0)},[s("tab-content",{attrs:{title:"Idea","before-change":t.validateIdeaTab}},[s("tab-content-structure",{attrs:{title:"Idea",tab_error:t.tab_error,is_saved:t.is_saved},scopedSlots:t._u([{key:"header",fn:function(){return[t.$root.job?s("div",{staticClass:"col-auto"},[s("span",{staticClass:"badge badge-info"},[t._v("Created "+t._s(t.$root.job.created_at))])]):t._e()]},proxy:!0}])},[s("idea",{attrs:{job_id:t.job_id,job_title:t.job_title,job_description:t.job_description,idea_form:t.idea_form,is_updating:t.is_updating},on:{load:function(e){return t.setJobId(e)},create:function(e){return t.createJob(e)},update:function(e){return t.updateJob(e)}}})],1)],1),s("tab-content",{attrs:{title:"Collections","before-change":t.validateCollectionsTab}},[s("tab-content-structure",{attrs:{title:"Collections",tab_error:t.tab_error,is_saved:t.is_saved},scopedSlots:t._u([{key:"header",fn:function(){return[s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{title:"Add a Collection"},on:{click:t.addResource}})],1)]},proxy:!0}])},t._l(t.$root.resources,function(e,i){return s("resource",{key:e.id,ref:"resourceComponents",refInFor:!0,attrs:{resource:e},on:{remove:function(e){return t.$root.resources.splice(i,1)}}})}),1)],1),s("tab-content",{attrs:{title:"Alignments","before-change":t.validateAlignmentsTab}},[s("tab-content-structure",{attrs:{title:"Alignment Specifications",tab_error:t.tab_error,is_saved:t.is_saved},scopedSlots:t._u([{key:"header",fn:function(){return[s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{title:"Add an Alignment"},on:{click:t.addMatch}})],1)]},proxy:!0}])},t._l(t.$root.matches,function(e,i){return s("match",{key:e.id,ref:"matchComponents",refInFor:!0,attrs:{match:e},on:{duplicate:function(e){return t.duplicateMatch(e)},submit:t.submit,remove:function(e){return t.$root.matches.splice(i,1)},"update:label":function(t){e.label=t}}})}),1)],1),s("tab-content",{attrs:{title:"Link Validation"}},[s("tab-content-structure",{attrs:{title:"Link Validation",tab_error:t.tab_error,is_saved:t.is_saved}},t._l(t.$root.matches,function(e){return t.$root.alignments[e.id]?s("links",{key:e.id,attrs:{match:e},on:{reload:t.getJobData}}):t._e()}),1)],1),s("tab-content",{attrs:{title:"Clusters"}},[s("tab-content-structure",{attrs:{title:"Clusters",tab_error:t.tab_error,is_saved:t.is_saved}},t._l(t.$root.matches,function(e){return t.$root.alignments[e.id]?s("cluster",{key:e.id,attrs:{match:e},on:{reload:t.getJobData}}):t._e()}),1)],1),s("tab-content",{attrs:{title:"Cluster Validation"}})],1)],1)},st=[],it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",["new"===t.idea_form||t.job_id?s("div",{staticClass:"border p-4 mt-4 bg-light"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"h3",attrs:{for:"idea"}},[t._v("What's your idea?")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("title")},attrs:{type:"text",id:"idea",disabled:t.is_updating},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("title"),expression:"errors.includes('title')"}],staticClass:"invalid-feedback"},[t._v("\n        Please indicate a name for your idea\n      ")])]),s("div",{staticClass:"form-group pt-3"},[s("label",{staticClass:"h3",attrs:{for:"description"}},[t._v("Describe your idea")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("description")},attrs:{id:"description",disabled:t.is_updating},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("description"),expression:"errors.includes('description')"}],staticClass:"invalid-feedback"},[t._v("\n        Please indicate a description for your idea\n      ")])]),s("div",{staticClass:"form-group row justify-content-end align-items-center pt-3 mb-0"},[t.$root.job?s("div",{staticClass:"col-auto"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.$root.job.created_at!==t.$root.job.updated_at,expression:"$root.job.created_at !== $root.job.updated_at"}],staticClass:"badge badge-info"},[t._v("\n            Updated "+t._s(t.$root.job.updated_at)+"\n        ")])]):t._e(),s("div",{staticClass:"col-auto"},[s("b-button",{attrs:{variant:"info"},on:{click:t.saveIdea}},[t._v("\n          "+t._s(t.job_id?"Update":"Create")+"\n        ")])],1)])]):t._e(),"existing"===t.idea_form||t.job_id?s("div",{staticClass:"bg-light border mt-4 p-4"},[s("div",{staticClass:"row justify-content-end align-items-center"},[s("span",{ref:"clipboard_copy_message",staticClass:"badge badge-info",attrs:{hidden:""}},[t._v("\n          Job ID copied to clipboard\n      ")]),t.job_id?[s("label",{staticClass:"h3 col-auto",attrs:{for:"job_id_copy"}},[t._v("Job ID")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.job_id,expression:"job_id"}],ref:"job_id_copy",staticClass:"col-md-3 col-auto",attrs:{type:"text",id:"job_id_copy",disabled:""},domProps:{value:t.job_id},on:{input:function(e){e.target.composing||(t.job_id=e.target.value)}}}),s("div",{staticClass:"col-auto"},[s("b-button",{on:{click:function(e){return t.copyToClipboard(t.$refs["job_id_copy"])}}},[s("octicon",{staticClass:"align-text-top",attrs:{name:"clippy"}})],1)],1)]:[s("label",{staticClass:"h3 col-auto",attrs:{for:"id_to_load"}},[t._v("Existing Job ID")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.id_to_load,expression:"id_to_load"}],staticClass:"col-md-3 col-auto",attrs:{type:"text",id:"id_to_load"},domProps:{value:t.id_to_load},on:{input:function(e){e.target.composing||(t.id_to_load=e.target.value)}}}),s("div",{staticClass:"col-auto"},[s("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.$emit("load",t.id_to_load)}}},[t._v("Load")])],1)]],2)]):t._e()])},ot=[],rt={name:"Idea",mixins:[z],data(){return{id_to_load:"",title:"",description:""}},props:{job_id:String,job_title:String,job_description:String,idea_form:String,is_updating:Boolean},methods:{validateIdea(){const t=this.validateField("title",this.title),e=this.validateField("description",this.description);return t&&e},saveIdea(){if(this.validateIdea()){const t=this.job_id?"update":"create";this.$emit(t,{job_id:this.job_id||void 0,job_title:this.title,job_description:this.description})}},copyToClipboard(t){let e=t.hasAttribute("disabled");e&&t.removeAttribute("disabled");let s=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),document.getSelection().removeAllRanges(),s&&document.getSelection().addRange(s),e&&t.setAttribute("disabled","disabled"),this.$refs["clipboard_copy_message"].removeAttribute("hidden"),setTimeout(()=>{this.$refs["clipboard_copy_message"].setAttribute("hidden","hidden")},2e3)}},watch:{job_title(){this.job_title&&(this.title=this.job_title)},job_description(){this.job_description&&(this.description=this.job_description)}}},at=rt,nt=Object(u["a"])(at,it,ot,!1,null,null,null),lt=nt.exports,ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("card",{attrs:{id:"resource_"+t.resource.id,type:"resources",label:t.resource.label,hasError:t.errors.length>0,editableLabel:!0},scopedSlots:t._u([{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto"},[s("button-delete",{attrs:{disabled:t.isUsedInAlignmentResults(),title:"Delete Collection"},on:{click:function(e){return t.$emit("remove")}}})],1)]},proxy:!0}])},[s("fieldset",{attrs:{disabled:t.isUsedInAlignmentResults()}},[s("sub-card",[s("div",{staticClass:"row"},[s("div",{staticClass:"form-group col-8"},[s("label",{attrs:{for:"dataset_"+t.resource.id}},[t._v("Dataset")]),s("v-select",{class:{"is-invalid":t.errors.includes("dataset")},attrs:{id:"dataset_"+t.resource.id},on:{change:function(e){t.resource.collection_id=""}},model:{value:t.resource.dataset_id,callback:function(e){t.$set(t.resource,"dataset_id",e)},expression:"resource.dataset_id"}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Choose a dataset")]),t._l(t.$root.datasets,function(e,i){return s("option",{domProps:{value:i}},[t._v("\n              "+t._s(e.title)+"\n            ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("dataset"),expression:"errors.includes('dataset')"}],staticClass:"invalid-feedback"},[t._v("\n            Please select a dataset\n          ")])],1),""!==t.resource.dataset_id?s("div",{staticClass:"form-group collection-input col-4"},[s("label",{attrs:{for:"collection_"+t.resource.id}},[t._v("Subset")]),s("v-select",{class:{"is-invalid":t.errors.includes("collection")},attrs:{id:"collection_"+t.resource.id},model:{value:t.resource.collection_id,callback:function(e){t.$set(t.resource,"collection_id",e)},expression:"resource.collection_id"}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Choose a subset")]),t._l(t.$root.datasets[t.resource.dataset_id].collections,function(e,i){return s("option",{domProps:{value:i}},[t._v("\n              "+t._s(i)+"\n            ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("collection"),expression:"errors.includes('collection')"}],staticClass:"invalid-feedback"},[t._v("\n            Please select a subset\n          ")])],1):t._e()])]),""!==t.resource.collection_id?s("sub-card",{attrs:{label:"Filter","add-button":0===t.resource.filter.conditions.length?"Add Filter Condition":""},on:{add:function(e){return t.addFilterCondition(t.resource.filter)}}},[s("conditions-group",{ref:"filterGroupComponent",attrs:{"conditions-group":t.resource.filter,"is-root":!0,uid:"resource_"+t.resource.id+"_filter_group_0","validate-method-name":"validateFilterCondition"},on:{add:function(e){return t.addFilterCondition(e)}},scopedSlots:t._u([{key:"default",fn:function(e){return[s("resource-filter-condition",{ref:"filterConditionComponents",attrs:{condition:e.condition,index:e.index,resource:t.resource},on:{add:function(t){return e.add()},remove:function(t){return e.remove()}}})]}}],null,!1,569695416)})],1):t._e(),""!==t.resource.collection_id?s("sub-card",{attrs:{label:"Sample"}},[s("div",{staticClass:"form-group row align-items-end mt-3"},[s("label",{staticClass:"col-auto",attrs:{for:"resource_"+t.resource.id+"_limit"}},[t._v("\n          Only use a sample of this amount of records (-1 is no limit):\n        ")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.resource.limit,expression:"resource.limit",modifiers:{number:!0}}],staticClass:"form-control col-1",class:{"is-invalid":t.errors.includes("limit")},attrs:{type:"number",min:"-1",id:"resource_"+t.resource.id+"_limit"},domProps:{value:t.resource.limit},on:{input:function(e){e.target.composing||t.$set(t.resource,"limit",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("limit"),expression:"errors.includes('limit')"}],staticClass:"invalid-feedback"},[t._v("\n          Please provide a limit, or -1 if there is no limit\n        ")])]),s("div",{staticClass:"form-check"},[s("input",{directives:[{name:"model",rawName:"v-model.boolean",value:t.resource.random,expression:"resource.random",modifiers:{boolean:!0}}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"resource_"+t.resource.id+"_random"},domProps:{checked:Array.isArray(t.resource.random)?t._i(t.resource.random,null)>-1:t.resource.random},on:{change:function(e){var s=t.resource.random,i=e.target,o=!!i.checked;if(Array.isArray(s)){var r=null,a=t._i(s,r);i.checked?a<0&&t.$set(t.resource,"random",s.concat([r])):a>-1&&t.$set(t.resource,"random",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.resource,"random",o)}}}),s("label",{staticClass:"form-check-label",attrs:{for:"resource_"+t.resource.id+"_random"}},[t._v("Randomize order")])])]):t._e(),""!==t.resource.collection_id?s("sub-card",{attrs:{label:"Relations","add-button":"Add Relation"},on:{add:t.addRelation}},[0===t.resource.related.length?s("div",{staticClass:"font-italic mt-3"},[t._v("\n        No relations\n      ")]):t._e(),t.resource.related.length>0?s("div",{staticClass:"form-group form-check mt-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.resource.related_array,expression:"resource.related_array"}],staticClass:"form-check-input",attrs:{id:t.resource.label+"related_array",type:"checkbox"},domProps:{checked:Array.isArray(t.resource.related_array)?t._i(t.resource.related_array,null)>-1:t.resource.related_array},on:{change:function(e){var s=t.resource.related_array,i=e.target,o=!!i.checked;if(Array.isArray(s)){var r=null,a=t._i(s,r);i.checked?a<0&&t.$set(t.resource,"related_array",s.concat([r])):a>-1&&t.$set(t.resource,"related_array",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.resource,"related_array",o)}}}),s("label",{staticClass:"form-check-label",attrs:{for:t.resource.label+"related_array"}},[t._v("\n          Use relations as combined source\n        ")])]):t._e(),t._l(t.resource.related,function(e,i){return s("div",{staticClass:"row"},[s("div",{staticClass:"form-group col-4"},[s("label",{attrs:{for:"resource_"+t.resource.id+"_related_"+e.id+"_resource"}},[t._v("\n            Related collection\n          ")]),s("v-select",{class:{"is-invalid":t.errors.includes("relations_resource_"+i)},attrs:{id:"resource_"+t.resource.id+"_related_"+e.id+"_resource"},model:{value:e.resource,callback:function(s){t.$set(e,"resource",s)},expression:"relation.resource"}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Choose a collection")]),t._l(t.$root.resources,function(e){return e.id!==t.resource.id?s("option",{domProps:{value:e.id}},[t._v("\n              "+t._s(e.label)+"\n            ")]):t._e()})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("relations_resource_"+i),expression:"errors.includes(`relations_resource_${index}`)"}],staticClass:"invalid-feedback"},[t._v("\n            Please provide a related collection\n          ")])],1),e.resource>0?s("div",{staticClass:"form-group col-4"},[s("label",{attrs:{for:"resource_"+t.resource.id+"_related_"+e.id+"_local_property"}},[t._v("\n            Local property\n          ")]),s("v-select",{class:{"is-invalid":t.errors.includes("relations_local_prop_"+i)},model:{value:e.local_property,callback:function(s){t.$set(e,"local_property",s)},expression:"relation.local_property"}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Select local property")]),t._l(t.$root.datasets[t.resource.dataset_id]["collections"][t.resource.collection_id],function(e,i){return s("option",{domProps:{value:i}},[t._v("\n              "+t._s(i)+"\n            ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("relations_local_prop_"+i),expression:"errors.includes(`relations_local_prop_${index}`)"}],staticClass:"invalid-feedback"},[t._v("\n            Please provide a local property\n          ")])],1):t._e(),e.resource>0?s("div",{staticClass:"form-group col-3"},[s("label",{attrs:{for:"resource_"+t.resource.id+"_related_"+e.id+"_remote_property"}},[t._v("\n            Remote property\n          ")]),s("v-select",{class:{"is-invalid":t.errors.includes("relations_remote_prop_"+i)},model:{value:e.remote_property,callback:function(s){t.$set(e,"remote_property",s)},expression:"relation.remote_property"}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Select remote property")]),t._l(t.getPropertiesForResource(e.resource),function(e,i){return s("option",{domProps:{value:i}},[t._v("\n              "+t._s(i)+"\n            ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("relations_remote_prop_"+i),expression:"errors.includes(`relations_remote_prop_${index}`)"}],staticClass:"invalid-feedback"},[t._v("\n            Please provide a remote property\n          ")])],1):t._e(),s("div",{staticClass:"form-group col-1 align-self-end"},[s("button-delete",{on:{click:function(e){return t.resource.related.splice(i,1)}}})],1)])})],2):t._e()],1)])},dt=[],ut=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"border p-4 mt-4 bg-light",class:{"is-invalid":t.hasError}},[s("div",{staticClass:"row flex-nowrap align-items-center justify-content-between"},[s("div",{staticClass:"col-auto"},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.id,expression:"id"}],attrs:{name:"chevron-down",scale:"3"}})],1),s("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.id,expression:"id"}],staticClass:"col-auto",class:{"flex-fill":t.fillLabel}},[t.editableLabel?s("edit-label",{attrs:{required:!0},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}}):s("div",{staticClass:"h2"},[t._v(t._s(t.label))]),t._t("title-extra")],2),t._t("columns")],2),t._t("header"),s("b-collapse",{ref:t.id,attrs:{id:t.id,accordion:t.type+"-accordion"},on:{show:function(e){return t.$emit("show")},hide:function(e){return t.$emit("hide")}}},[t._t("default")],2)],2)},pt=[],ht={name:"Card",props:{id:String,type:String,label:String,hasError:{type:Boolean,default:!1},editableLabel:{type:Boolean,default:!1},fillLabel:{type:Boolean,default:!0}}},mt=ht,vt=Object(u["a"])(mt,ut,pt,!1,null,null,null),_t=vt.exports,ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-white border p-3",class:{"mt-4":!t.isFirst&&!t.smallSpacing,"mt-2":!t.isFirst&&t.smallSpacing}},[t.hasColumns||t.hasCollapse||t.label||t.hasInfo||t.addButton?s("div",{staticClass:"row align-items-center justify-content-between"},[t.hasCollapse?s("div",{staticClass:"col-auto"},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.id,expression:"id"}],attrs:{name:"chevron-down",scale:"2"}})],1):t._e(),t.label?s("div",{staticClass:"col-auto pr-0"},[s("h3",[t._v(t._s(t.label))])]):t._e(),t.hasInfo?s("div",{staticClass:"col-auto pl-0",class:{"mr-auto":!t.addButton}},[t._t("info")],2):t._e(),t._t("columns"),t.addButton?s("div",{staticClass:"col-auto ml-auto"},[s("button-add",{attrs:{title:t.addButton},on:{click:function(e){return t.$emit("add")}}})],1):t._e()],2):t._e(),t.hasCollapse?s("b-collapse",{ref:t.id,attrs:{id:t.id,accordion:t.type+"-accordion"},on:{show:function(e){return t.$emit("show")},hide:function(e){return t.$emit("hide")}}},[t._t("default")],2):t._t("default")],2)},gt=[],bt={name:"SubCard",props:{id:String,type:String,label:String,addButton:String,hasCollapse:{type:Boolean,default:!1},hasInfo:{type:Boolean,default:!1},hasColumns:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!1},smallSpacing:{type:Boolean,default:!1}}},yt=bt,Ct=Object(u["a"])(yt,ft,gt,!1,null,null,null),wt=Ct.exports,xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.conditionsGroup.conditions?s("div",{staticClass:"shadow p-3 border mt-3",class:[{"is-invalid":t.errors.length>0}].concat(t.styleClass)},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto"},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.uid,expression:"uid"}],attrs:{name:"chevron-down",scale:"2"}})],1),t.conditionsGroup.conditions.length>0?s("div",{staticClass:"col"},[s("v-select",{model:{value:t.conditionsGroup.type,callback:function(e){t.$set(t.conditionsGroup,"type",e)},expression:"conditionsGroup.type"}},[s("option",{attrs:{value:"AND"}},[t._v("All conditions must be met (AND)")]),s("option",{attrs:{value:"OR"}},[t._v("At least one of the conditions must be met (OR)")])])],1):t._e(),t.conditionsGroup.conditions.length<1?s("div",{staticClass:"col font-italic"},[t._v("\n      No conditions\n\n      "),s("div",{staticClass:"invalid-feedback d-block"},[t.errors.includes("conditions")?[t._v("\n          Please provide at least one condition\n        ")]:t._e()],2)]):t._e(),t.conditionsGroup.conditions.length>0?s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row"},[t.isRoot?t._e():s("div",{staticClass:"col-auto"},[s("button-delete",{staticClass:"pt-1 pr-0",attrs:{title:"Delete this group"},on:{click:function(e){return t.$emit("remove",t.index)}}})],1),s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{title:"Add condition"},on:{click:function(e){return t.$emit("add",t.conditionsGroup)}}})],1)])]):t._e()]),s("b-collapse",{ref:t.uid,attrs:{visible:"",id:t.uid}},t._l(t.conditionsGroup.conditions,function(e,i){return s("conditions-group",{key:i,ref:"conditionGroupComponents",refInFor:!0,attrs:{index:i,uid:t.uid+"_"+i,"conditions-group":e,"should-have-conditions":t.shouldHaveConditions,"validate-method-name":t.validateMethodName},on:{add:function(e){return t.$emit("add",e)},remove:function(e){return t.removeCondition(e)},promote:function(e){return t.promoteConditionGroup(e)},demote:function(e){return t.demoteConditionGroup(e)}},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("default",null,null,e)]}}],null,!0)})}),1)],1):s("div",[t._t("default",null,{index:t.index,condition:t.conditionsGroup,add:function(){return t.$emit("promote",t.index)},remove:function(){return t.$emit("remove",t.index)}})],2)},$t=[],kt={name:"ConditionsGroup",mixins:[z],props:{uid:"",index:0,conditionsGroup:{},validateMethodName:String,isRoot:{type:Boolean,default:!1},shouldHaveConditions:{type:Boolean,default:!1}},computed:{styleClass(){const t=[];return this.isRoot&&t.push("mt-3"),this.isRoot||this.$parent.$parent.styleClass.includes("bg-primary-light")?t.push("bg-info-light","border-info"):t.push("bg-primary-light","border-primary"),t}},methods:{validateConditionsGroup(){if(this.conditionsGroup.conditions&&this.conditionsGroup.conditions.length>0){this.validateField("conditions",!0);const t=!this.$refs.conditionGroupComponents.map(t=>t.validateConditionsGroup()).includes(!1);return this.validateField(this.uid,t),t}if(this.conditionsGroup.conditions&&this.shouldHaveConditions){const t=this.validateField("conditions",this.conditionsGroup.conditions.length>0);return this.validateField(this.uid,t),t}return!(!this.conditionsGroup.conditions&&this.validateMethodName&&this.$children.length>0&&"function"===typeof this.$children[0][this.validateMethodName])||this.$children[0][this.validateMethodName]()},removeCondition(t){this.conditionsGroup.conditions.splice(t,1),this.isRoot||1!==this.conditionsGroup.conditions.length||this.$emit("demote",this.index)},promoteConditionGroup(t){const e=this.conditionsGroup.conditions[t],s=JSON.parse(JSON.stringify(e)),i={type:"AND",conditions:[s]};this.$set(this.conditionsGroup.conditions,t,i),this.$emit("add",this.conditionsGroup.conditions[t])},demoteConditionGroup(t){const e=this.conditionsGroup.conditions[t].conditions[0],s=JSON.parse(JSON.stringify(e));this.$set(this.conditionsGroup.conditions,t,s)}}},jt=kt,It=Object(u["a"])(jt,xt,$t,!1,null,null,null),St=It.exports,Ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"border border-dark p-3 mt-3"},[s("div",{staticClass:"row align-items-center justify-content-between mb-2"},[s("div",{staticClass:"col-auto"},[t._v("\n      Property:\n    ")]),s("div",{staticClass:"col"},[s("property",{ref:"propertyComponent",attrs:{property:t.condition.property,singular:!0},on:{resetProperty:function(e){return t.resetProperty(t.condition.property,e)}}})],1),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("button-delete",{staticClass:"pt-1 pr-0",attrs:{title:"Delete this Filter Condition"},on:{click:function(e){return t.$emit("remove",t.index)}}})],1),s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{title:"Add Filter Condition and Create Group"},on:{click:function(e){return t.$emit("add")}}})],1)])])]),s("div",{staticClass:"form-row align-items-center"},[s("div",{staticClass:"col-3"},[s("v-select",{class:{"is-invalid":t.errors.includes("condition")},model:{value:t.condition.type,callback:function(e){t.$set(t.condition,"type",e)},expression:"condition.type"}},[s("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("Choose a filter type")]),s("option",{attrs:{value:"="}},[t._v("Equal to")]),s("option",{attrs:{value:"!="}},[t._v("Not equal to")]),s("option",{attrs:{value:"not_null"}},[t._v("Is not null")]),s("option",{attrs:{value:"date_is_within"}},[t._v("date is within")]),s("option",{attrs:{value:"appearances"}},[t._v("appearances of property")]),s("option",{attrs:{value:"ilike"}},[t._v("Contains (use % for wildcard)")])])],1),["=","!=","date_is_within","ilike"].indexOf(t.condition.type)>-1?s("div",{staticClass:"col-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.condition.value,expression:"condition.value"}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("value")},attrs:{type:"text",placeholder:"Enter a value"},domProps:{value:t.condition.value},on:{input:function(e){e.target.composing||t.$set(t.condition,"value",e.target.value)}}})]):t._e(),"appearances"==t.condition.type?s("div",{staticClass:"col-2"},[s("v-select",{model:{value:t.condition.operator,callback:function(e){t.$set(t.condition,"operator",e)},expression:"condition.operator"}},[s("option",{attrs:{value:"<=",selected:""}},[t._v("Max.")]),s("option",{attrs:{value:">=",selected:""}},[t._v("Min.")]),s("option",{attrs:{value:"=",selected:""}},[t._v("Exactly")])])],1):t._e(),"appearances"==t.condition.type?s("div",{staticClass:"col-1"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.condition.value,expression:"condition.value",modifiers:{number:!0}}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("value")},attrs:{type:"number",min:"0",step:"1"},domProps:{value:t.condition.value},on:{input:function(e){e.target.composing||t.$set(t.condition,"value",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):t._e(),s("div",{staticClass:"form-check"},[s("input",{directives:[{name:"model",rawName:"v-model.boolean",value:t.condition.invert,expression:"condition.invert",modifiers:{boolean:!0}}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"resource_"+t.resource.id+"_condition_"+t.index+"_invert"},domProps:{checked:Array.isArray(t.condition.invert)?t._i(t.condition.invert,null)>-1:t.condition.invert},on:{change:function(e){var s=t.condition.invert,i=e.target,o=!!i.checked;if(Array.isArray(s)){var r=null,a=t._i(s,r);i.checked?a<0&&t.$set(t.condition,"invert",s.concat([r])):a>-1&&t.$set(t.condition,"invert",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.condition,"invert",o)}}}),s("label",{staticClass:"form-check-label",attrs:{for:"resource_"+t.resource.id+"_condition_"+t.index+"_invert"}},[t._v("Invert")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("property")||t.errors.includes("condition")||t.errors.includes("value"),expression:"errors.includes('property') || errors.includes('condition') || errors.includes('value')"}],staticClass:"row"},[s("div",{staticClass:"invalid-feedback d-block pl-3"},[t.errors.includes("property")?[t._v("\n        Please select a property\n      ")]:t._e(),t.errors.includes("property")&&(t.errors.includes("condition")||t.errors.includes("value"))?[s("br")]:t._e(),t.errors.includes("condition")?[t._v("\n        Please provide a filter type\n      ")]:t.errors.includes("value")&&"appearances"===t.condition.type?[t._v("\n        Please provide a number for the condition\n      ")]:t.errors.includes("value")?[t._v("\n        Please provide a value for the condition\n      ")]:t._e()],2)])])},Rt=[],At={name:"ResourceFilterCondition",mixins:[z],props:["resource","condition","index"],methods:{validateFilterCondition(){const t=this.validateField("property",this.$refs.propertyComponent.validateProperty()),e=this.validateField("condition",this.condition.type);let s=!1;return s=["=","!=","date_is_within","ilike"].includes(this.condition.type)?this.validateField("value",this.condition.value):"appearances"===this.condition.type?this.validateField("value",!isNaN(parseInt(this.condition.value))&&parseInt(this.condition.value)>0):this.validateField("value",!0),t&&e&&s},resetProperty(t,e){let s=t.slice(0,e);s.push(""),s.length%2>0&&s.push(""),this.$set(this.condition,"property",s)}}},Mt=At,Pt=Object(u["a"])(Mt,Ot,Rt,!1,null,null,null),Et=Pt.exports,Tt={name:"Resource",mixins:[z],components:{Card:_t,SubCard:wt,ConditionsGroup:St,ResourceFilterCondition:Et},data(){return{prevDatasetId:"",prevCollectionId:""}},props:{resource:Object},computed:{autoLabel(){if(this.prevDatasetId&&this.prevCollectionId){const t=this.$root.datasets[this.prevDatasetId].title;return`${t} [type: ${this.prevCollectionId}]`}return"Collection "+(this.resource.id+1)}},methods:{validateResource(){const t=this.validateField("dataset",this.resource.dataset_id&&this.$root.datasets.hasOwnProperty(this.resource.dataset_id)),e=this.$root.datasets[this.resource.dataset_id],s=this.validateField("collection",this.resource.collection_id&&e&&e.collections.hasOwnProperty(this.resource.collection_id)),i=parseInt(this.resource.limit),o=this.validateField("limit",!isNaN(i)&&(-1===i||i>0));let r=!0;this.errors=this.errors.filter(t=>!t.startsWith("relations_")),this.resource.related.forEach((t,s)=>{const i=this.$root.resources.find(e=>e.id===parseInt(t.resource)),o=this.validateField(`relations_resource_${s}`,t.resource&&i),a=e&&e.collections[this.resource.collection_id],n=this.validateField(`relations_local_prop_${s}`,t.local_property&&a&&a.hasOwnProperty(t.local_property)),l=i&&this.$root.datasets[i.dataset_id],c=l&&l.collections[i.collection_id],d=this.validateField(`relations_remote_prop_${s}`,t.remote_property&&c&&c.hasOwnProperty(t.remote_property));o&&n&&d||(r=!1)});let a=!0;return this.$refs.filterGroupComponent&&(a=this.$refs.filterGroupComponent.validateConditionsGroup()),s&&t&&o&&r&&a},isUsedInAlignmentResults(){const t=Object.keys(this.$root.alignments);for(let e=0;e<this.$root.matches.length;e++){const s=this.$root.matches[e];if(t.includes(s.id.toString())&&(s.sources.includes(this.resource.id.toString())||s.targets.includes(this.resource.id.toString())))return!0}return!1},addRelation(t){t&&t.target.blur(),this.resource.related.push({resource:"",local_property:"",remote_property:""})},addFilterCondition(t){t.conditions.push({type:"",property:[this.resource.id,""]})},getPropertiesForResource(t){const e=this.$root.getResourceById(t);return this.$root.datasets[e.dataset_id]["collections"][e.collection_id]}},updated(){this.resource.label===this.autoLabel&&(this.prevDatasetId=this.resource.dataset_id,this.prevCollectionId=this.resource.collection_id,this.$set(this.resource,"label",this.autoLabel))},mounted(){this.prevDatasetId=this.resource.dataset_id,this.prevCollectionId=this.resource.collection_id,this.resource.label||this.$set(this.resource,"label",this.autoLabel)}},Nt=Tt,Ft=Object(u["a"])(Nt,ct,dt,!1,null,null,null),Lt=Ft.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("card",{attrs:{id:"match_"+t.match.id,type:"matches",label:t.match.label,hasError:t.errors.length>0,editableLabel:!0,fillLabel:!1},scopedSlots:t._u([{key:"title-extra",fn:function(){return[s("div",{staticClass:"form-row"},[s("div",{staticClass:"col form-check mb-1 pl-0"},[s("b-form-checkbox",{attrs:{id:"match_"+t.match.id+"_is_association",disabled:!!t.jobResults,title:"Check this box if this Alignment is intended for creating associations"},model:{value:t.match.is_association,callback:function(e){t.$set(t.match,"is_association",e)},expression:"match.is_association"}},[t._v("\n          Association\n        ")])],1)])]},proxy:!0},{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto flex-fill"},[t.jobResults?s("div",[s("div",[s("strong",[t._v("Request received at: ")]),t._v(t._s(t.jobResults.requested_at)+"\n        ")]),t.jobResults.processing_at?s("div",[s("strong",[t._v("Processing started at: ")]),t._v(t._s(t.jobResults.processing_at)+"\n        ")]):t._e(),t.jobResults.finished_at?s("div",[s("strong",[t._v("Processing finished at: ")]),t._v(t._s(t.jobResults.finished_at)+"\n        ")]):t._e(),s("div",[s("strong",[t._v("Status: ")]),s("pre",{staticClass:"d-inline"},[t._v(t._s(t.jobResults.status))])]),"Finished"===t.jobResults.status?s("div",[s("strong",[t._v("Links found:")]),t._v(" "+t._s(t.jobResults.links_count||0)+"\n        ")]):t._e()]):t._e()]),s("div",{staticClass:"col-auto"},[s("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.$emit("duplicate",t.match)}}},[t._v("Duplicate")])],1),t.jobResults&&"Finished"!==t.jobResults.status?t._e():s("div",{staticClass:"col-auto"},[s("b-button",{attrs:{variant:"info"},on:{click:t.runAlignment}},[t._v("\n        Run\n        "),t.jobResults?[t._v("again")]:t._e()],2)],1),s("div",{staticClass:"col-auto"},[s("button-delete",{attrs:{scale:2,disabled:!!t.jobResults,title:"Delete this Alignment"},on:{click:function(e){return t.$emit("remove")}}})],1)]},proxy:!0}])},[s("fieldset",{attrs:{disabled:!!t.jobResults}},[s("sub-card",{attrs:{label:"Sources","has-info":!0,"add-button":"Add a Collection as a Source"},on:{add:function(e){return t.addMatchResource("sources",e)}},scopedSlots:t._u([{key:"info",fn:function(){return[s("match-sources-info")]},proxy:!0}])},[s("div",{staticClass:"row pl-5"},[s("div",{staticClass:"col"},[t._l(t.match.sources,function(e,i){return s("match-resource",{key:i,ref:"sourceResourceComponents",refInFor:!0,attrs:{match_resource_id:"source_"+i,match:t.match,match_resource:t.$root.getResourceById(e),resources_key:"sources"},on:{input:function(e){return t.updateMatchResource("sources",i,e)},remove:function(e){return t.deleteMatchResource("sources",i)}}})}),s("div",{staticClass:"invalid-feedback d-block"},[t.errors.includes("sources")?[t._v("\n              Please provide at least one source\n            ")]:t._e()],2)],2)])]),s("sub-card",{attrs:{label:"Targets","has-info":!0,"add-button":"Add a Collection as a Target"},on:{add:function(e){return t.addMatchResource("targets",e)}},scopedSlots:t._u([{key:"info",fn:function(){return[s("match-targets-info")]},proxy:!0}])},[s("div",{staticClass:"row pl-5"},[s("div",{staticClass:"col"},[t._l(t.match.targets,function(e,i){return s("match-resource",{key:i,ref:"targetResourceComponents",refInFor:!0,attrs:{match_resource_id:"target_"+i,match:t.match,match_resource:t.$root.getResourceById(e),resources_key:"targets"},on:{input:function(e){return t.updateMatchResource("targets",i,e)},remove:function(e){return t.deleteMatchResource("targets",i)}}})}),s("div",{staticClass:"invalid-feedback d-block"},[t.errors.includes("targets")?[t._v("\n              Please provide at least one target\n            ")]:t._e()],2)],2)])]),s("sub-card",{attrs:{label:"Matching Methods","has-info":!0,"add-button":0===t.match.conditions.length?"Add a Matching Method":""},on:{add:function(e){return t.addMatchCondition(t.match)}},scopedSlots:t._u([{key:"info",fn:function(){return[s("match-matching-methods-info")]},proxy:!0}])},[s("conditions-group",{ref:"matchingMethodGroupComponent",attrs:{"conditions-group":t.match,"is-root":!0,"should-have-conditions":!0,uid:"match_"+t.match.id+"_group_0","validate-method-name":"validateMatchCondition"},on:{add:function(e){return t.addMatchCondition(e)}},scopedSlots:t._u([{key:"default",fn:function(t){return[s("match-condition",{attrs:{condition:t.condition,index:t.index},on:{add:function(e){return t.add()},remove:function(e){return t.remove()}}})]}}])})],1)],1)])},Bt=[],Gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"SOURCES"}},[s("div",{staticClass:"h2"},[t._v("COMPOSING VIRTUAL SOURCE FROM COLLECTIONS")]),s("img",{attrs:{width:"700px",src:"/static/images/VirtualCollection.png"}}),s("p",{staticClass:"h5 text-left pt-4 pb-4"},[t._v("\n    All collections of interest selected as sources are combined into\n    a "),s("strong",[t._v("SINGLE VIRTUAL COLLECTION")]),t._v("> with the resource's id and the value of the selected\n    properties. For a single dataset, multiple "),s("strong",[t._v("SEMANTICALLY SIMILAR PROPERTIES")]),t._v(" can be\n    selected.\n  ")]),s("hr"),s("img",{staticClass:"pb-4",attrs:{width:"1000px",src:"/static/images/Documentation.png"}})])},Vt=[],zt={},Jt=Object(u["a"])(zt,Gt,Vt,!1,null,null,null),Ut=Jt.exports,Ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"TARGETS"}},[s("div",{staticClass:"h2"},[t._v("MATCHING SOURCE AGAINST TARGET")]),s("img",{attrs:{src:"/static/images/Source_Target.png",width:"800px"}}),s("ul",{staticClass:"text-left pt-5"},[s("li",[t._v("Several collections can be selected as "),s("span",{staticClass:"text-info"},[t._v("SOURCE")]),t._v(".")]),s("li",[t._v("Several collections can be selected as "),s("span",{staticClass:"text-info"},[t._v("TARGET")]),t._v(".")]),s("li",[t._v("For each collection, be it the "),s("span",{staticClass:"text-info"},[t._v("TARGET")]),t._v(" or the "),s("span",{staticClass:"text-info"},[t._v("SOURCE")]),t._v(" several properties can be selected.\n    ")]),s("li",[t._v("Overall, "),s("strong",[t._v("ALL")]),t._v(" selected properties "),s("strong",[t._v("MUST")]),t._v(" be concistent for a\n      particuilar the type of "),s("span",{staticClass:"text-info"},[t._v("MATCHING METHOD")]),t._v(" in mind.\n    ")])]),s("hr")])},Wt=[],qt={},Yt=Object(u["a"])(qt,Ht,Wt,!1,null,null,null),Xt=Yt.exports,Zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"MATCHING METHODS AND LOGICAL OPERATOR"}},[s("div",{staticClass:"h3 pt-5 text-info"},[t._v("Simple Matching Scenario-1")]),s("img",{attrs:{width:"700px",src:"/static/images/4_MethodSimple.png"}}),s("div",{staticClass:"h5"},[t._v("Matching two datasets using "),s("strong",[t._v("one")]),t._v(" property per dataset")]),s("div",{staticClass:"h3 pt-5 text-info"},[t._v("Simple Matching Scenario-2")]),s("img",{attrs:{width:"700px",src:"/static/images/5_MethodProp.png"}}),s("div",{staticClass:"h5"},[t._v("\n    More than one property per dataset is allowed."),s("br"),t._v("\n    Only, all aligned property should be semantically similar.\n  ")]),s("div",{staticClass:"h3 pt-5 text-info"},[t._v("\n    Simple Matching Scenario-3\n  ")]),s("img",{attrs:{width:"700px",src:"/static/images/6_MethodDs.png"}}),s("div",{staticClass:"h5"},[t._v("\n    More than one dataset is allowed for a "),s("span",{staticClass:"text-info"},[t._v("SOURCE")]),t._v(" or a\n    "),s("span",{staticClass:"text-info"},[t._v("TARGET")]),t._v("."),s("br"),t._v("\n    Only, all aligned property should be semantically similar."),s("br"),t._v("\n    The logical expression provide a human readable of how it is implemented.\n  ")]),s("div",{staticClass:"h3 pt-5 text-info"},[t._v("Complex Matching Scenario")]),s("img",{attrs:{width:"700px",src:"/static/images/7_MethodFull.png"}}),s("div",{staticClass:"h5"},[t._v("\n    More than one method is allowed."),s("br"),t._v("\n    Within each method, a "),s("strong",[t._v("DISJUNCTION")]),t._v(" ("),s("span",{staticClass:"text-info"},[t._v("OR")]),t._v(") operator is\n    applied over each pair of properties "),s("strong",[t._v("across")]),t._v(" two datasets."),s("br"),t._v("\n    A "),s("strong",[t._v("DISJUNCTION")]),t._v(" ("),s("span",{staticClass:"text-info"},[t._v("OR")]),t._v(") OR "),s("strong",[t._v("CONJUNCTION")]),t._v("\n    ("),s("span",{staticClass:"text-info"},[t._v("AND")]),t._v(") operator is necessary whenever more than one methods is\n    required."),s("br")])])},Kt=[],Qt={},te=Object(u["a"])(Qt,Zt,Kt,!1,null,null,null),ee=te.exports,se=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-white row align-items-center"},[t.match_resource?s("div",{staticClass:"ml-3 pt-2",on:{mouseenter:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[t._v("\n    "+t._s(t.match_resource.label)+"\n  ")]):s("div",{staticClass:"col-auto pr-0",on:{mouseenter:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[s("v-select",{class:{"is-invalid":t.errors.includes("resource")},attrs:{value:t.match_resource,id:"match_"+t.match.id+"_resource_label_"+t.match_resource_id},on:{input:function(e){t.$emit("input",e),t.hovering=!1}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Choose a collection")]),t._l(t.resources,function(e,i){return s("option",{domProps:{value:e.id}},[t._v(t._s(e.label)+"\n      ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("resource"),expression:"errors.includes('resource')"}],staticClass:"invalid-feedback"},[t._v("\n      Please select a collection\n    ")])],1),s("div",{staticClass:"col-auto pl-0",on:{mouseenter:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[s("button-delete",{class:"pt-1"+t.showOnHover,attrs:{scale:1.4},on:{click:function(e){return t.$emit("remove")}}})],1)])},ie=[],oe={name:"MatchResource",mixins:[z],data(){return{hovering:!1}},props:{match:Object,match_resource:Object,match_resource_id:String,resources_key:String},computed:{resources(){return this.$root.resources.filter(t=>{return!this.match[this.resources_key].includes(t.id.toString())})},showOnHover(){return this.hovering?"":" invisible"}},methods:{validateResource(){return this.validateField("resource",this.match_resource&&""!==this.match_resource)}}},re=oe,ae=Object(u["a"])(re,se,ie,!1,null,null,null),ne=ae.exports,le=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"border border-dark p-3 mt-3"},[s("div",{staticClass:"row align-items-start justify-content-between mb-2"},[s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row"},[s("label",{staticClass:"h4 col-auto"},[t._v("Method")]),s("div",{staticClass:"col-auto"},[s("v-select",{class:{"is-invalid":t.errors.includes("method_name")},on:{input:t.handleMethodIndexChange},model:{value:t.condition.method_name,callback:function(e){t.$set(t.condition,"method_name",e)},expression:"condition.method_name"}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Select a method")]),t._l(t.matchingMethods,function(e,i){return s("option",{domProps:{value:i}},[t._v(t._s(e.label))])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("method_name"),expression:"errors.includes('method_name')"}],staticClass:"invalid-feedback"},[t._v("\n            Please specify a matching method\n          ")])],1)])]),s("div",{staticClass:"col-4"},[s("div",{staticClass:"row"},t._l(t.methodValueTemplate.items,function(e,i){return s("div",{staticClass:"col"},[s("div",{staticClass:"form-group"},[s("label",[s("span",[t._v("\n                                  "+t._s(e.label)+"\n                              ")]),"number"===typeof e.type?s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.condition.method_value[e.key],expression:"condition.method_value[item.key]",modifiers:{number:!0}}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("method_value_"+e.key)},attrs:{type:"number",step:"0.1"},domProps:{value:t.condition.method_value[e.key]},on:{input:function(s){s.target.composing||t.$set(t.condition.method_value,e.key,t._n(s.target.value))},blur:function(e){return t.$forceUpdate()}}}):t._e(),e.type.hasOwnProperty("type")&&"matching_label"===e.type.type?s("select",{directives:[{name:"model",rawName:"v-model",value:t.condition.method_value[e.key].value,expression:"condition.method_value[item.key].value"}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("method_value_"+e.key)},on:{change:function(s){var i=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.condition.method_value[e.key],"value",s.target.multiple?i:i[0])}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Select a Mapping")]),t._l(t.$root.matches,function(e){return s("option",{domProps:{value:e.id}},[t._v(t._s(e.label))])})],2):t._e(),e.choices?s("select",{directives:[{name:"model",rawName:"v-model",value:t.condition.method_value[e.key],expression:"condition.method_value[item.key]"}],staticClass:"form-control",class:{"is-invalid":t.errors.includes("method_value_"+e.key)},on:{change:function(s){var i=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.condition.method_value,e.key,s.target.multiple?i:i[0])}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Select an option")]),t._l(e.choices,function(e,i){return s("option",{domProps:{value:e}},[t._v(t._s(i)+"\n                ")])})],2):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes("method_value_"+e.key),expression:"errors.includes(`method_value_${item.key}`)"}],staticClass:"invalid-feedback"},[t._v("\n                Please specify a valid value\n              ")])])])])}),0)]),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("button-delete",{staticClass:"pt-1 pr-0",attrs:{title:"Delete this Method"},on:{click:function(e){return t.$emit("remove",t.index)}}})],1),s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{title:"Add Method and Create Group"},on:{click:function(e){return t.$emit("add")}}})],1)])])]),t._l(["sources","targets"],function(e){return s("div",{staticClass:"row pl-5 mb-3"},[s("div",{staticClass:"col"},[s("div",{staticClass:"row"},[s("div",{staticClass:"h4 col-auto"},[t._v(t._s(t._f("capitalize")(e))+" properties")]),t.unusedResources[e].length>0?s("div",{staticClass:"col-auto form-group"},[s("v-select",{on:{input:function(s){return t.condition[e][s].push({property:[s,""]})}}},[s("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("Add property for Collection:")]),t._l(t.unusedResources[e],function(e){return s("option",{domProps:{value:e}},[t._v("\n              "+t._s(t.$root.getResourceById(e).label)+"\n            ")])})],2)],1):t._e()]),t._l(t.condition[e],function(i){return t._l(i,function(o,r){return s("div",{staticClass:"row"},[s("div",{staticClass:"col ml-5 p-3 border-top"},[o.property?s("property",{ref:"propertyComponents",refInFor:!0,attrs:{property:o.property},on:{clone:function(t){return i.splice(r+1,0,{property:[i[r]["property"][0],""]})},delete:function(e){return t.$delete(i,r)},resetProperty:function(e){return t.resetProperty(i,r,e)}}}):t._e(),s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto h5"},[t._v("Transformers")]),s("div",{staticClass:"col-auto"},[s("button-add",{attrs:{scale:"0.7",title:"Add Transformer"},on:{click:function(e){t.$utilities.getOrCreate(t.$set,"transformers",[]).push("")}}})],1),t._l(o.transformers,function(i,r){return s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto pr-0"},[s("v-select",{class:{"is-invalid":t.errors.includes(e+"_transformers")},model:{value:o.transformers[r],callback:function(e){t.$set(o.transformers,r,e)},expression:"resource.transformers[index]"}},[s("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Select a function")]),t._l(t.transformers,function(e){return s("option",{domProps:{value:e}},[t._v(t._s(e)+"\n                      ")])})],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.errors.includes(e+"_transformers"),expression:"errors.includes(`${resources_key}_transformers`)"}],staticClass:"invalid-feedback"},[t._v("\n                      Please specify a transformer or remove the transformer\n                    ")])],1),s("div",{staticClass:"col-auto pl-0"},[s("button-delete",{staticClass:"pt-1",attrs:{scale:"1.3"},on:{click:function(t){return o.transformers.splice(r,1)}}})],1)])])})],2)],1)])})}),s("div",{staticClass:"invalid-feedback d-block"},[t.errors.includes(e)?[t._v("\n          Please specify at least one property\n        ")]:t._e()],2)],2)])})],2)},ce=[],de={matchingMethods:{"=":{label:"Exact Match",items:[]},LL_SOUNDEX:{label:"Similar Soundex",items:[{key:"threshold",label:"Similarity threshold",type:.7,minValue:0,maxValue:1}]},BLOOTHOOFT_REDUCT:{label:"Same Bloothooft Reduction",items:[{key:"name_type",label:"Type of Name",type:"",choices:{"First name":"first_name","Family name":"family name"}},{key:"threshold",label:"Similarity threshold",type:.7,minValue:0,maxValue:1}]},BLOOTHOOFT_REDUCT_APPROX:{label:"Similar Bloothooft Reduction",items:[{key:"name_type",label:"Type of Name",type:"",choices:{"First name":"first_name","Family name":"family name"}},{key:"threshold",label:"Similarity threshold",type:.7,minValue:0,maxValue:1}]},TRIGRAM_DISTANCE:{label:"Trigram distance",items:[{key:"threshold",label:"Similarity threshold",type:.3,minValue:0,maxValue:1}]},LEVENSHTEIN:{label:"Levenshtein distance",items:[{key:"max_distance",label:"Maximum distance",type:1,minValue:0}]},TIME_DELTA:{label:"Time Delta",items:[{key:"days",label:"",type:0,minValue:0},{key:"multiplier",label:"",type:"",choices:{Years:365,Months:30,Days:1}}]},SAME_YEAR_MONTH:{label:"Same Year/Month",items:[{key:"date_part",label:"",type:"",choices:{Year:"year",Month:"month","Year and Month":"year_month"}}]},DISTANCE_IS_BETWEEN:{label:"Distance is between",items:[{key:"distance_start",label:"Start",type:0},{key:"distance_end",label:"End",type:0}]},IS_IN_SET:{label:"Is a Match in Set",items:[{key:"alignment",label:"",type:{type:"matching_label"}}]}},transformers:["ecartico_full_name","to_date_immutable"]},ue={name:"MatchCondition",mixins:[z],data(){return{transformers:de.transformers,matchingMethods:de.matchingMethods}},props:["condition","index"],computed:{methodValueTemplate(){return this.matchingMethods.hasOwnProperty(this.condition.method_name)?this.matchingMethods[this.condition.method_name]:{label:"",items:[]}},unusedResources(){let t=["sources","targets"],e={};return t.forEach(t=>{e[t]=Object.keys(this.condition[t]).filter(e=>this.condition[t][e].length<1)}),e}},methods:{validateMatchCondition(){const t=this.validateField("method_name",this.condition.method_name.length>0);let e=!0;this.errors=this.errors.filter(t=>!t.startsWith("method_value_")),this.methodValueTemplate.items.forEach(t=>{const s=this.condition.method_value[t.key];let i=!0;t.hasOwnProperty("minValue")&&(isNaN(parseFloat(s))||parseFloat(s)<t.minValue)&&(i=!1),t.hasOwnProperty("maxValue")&&(isNaN(parseFloat(s))||parseFloat(s)>t.maxValue)&&(i=!1),t.hasOwnProperty("choices")&&!Object.values(t.choices).includes(s)&&(i=!1),"IS_IN_SET"!==this.condition.method_name||void 0!==s.value&&""!==s.value||(i=!1),this.validateField(`method_value_${t.key}`,i)||(e=!1)});const s=!this.$refs.propertyComponents.map(t=>t.validateProperty()).includes(!1);let i=!0;return["sources","targets"].forEach(t=>{Object.keys(this.condition[t]).forEach(e=>{this.validateField(t,this.condition[t][e].length>0)||(i=!1),this.condition[t][e].forEach(e=>{e.hasOwnProperty("transformers")&&!this.validateField(`${t}_transformers`,!e.transformers.includes(""))&&(i=!1)})})}),t&&e&&s&&i},handleMethodIndexChange(){this.condition.method_value={},this.methodValueTemplate.items.forEach(t=>{this.condition.method_value[t.key]=t.type})},resetProperty(t,e,s){let i=t[e].property,o=i.slice(0,s);o.push(""),o.length%2>0&&o.push(""),this.$set(t[e],"property",o)}}},pe=ue,he=Object(u["a"])(pe,le,ce,!1,null,null,null),me=he.exports,ve={name:"Match",mixins:[z],components:{Card:_t,SubCard:wt,MatchSourcesInfo:Ut,MatchTargetsInfo:Xt,MatchMatchingMethodsInfo:ee,MatchResource:ne,MatchCondition:me,ConditionsGroup:St},props:{match:Object},computed:{jobResults(){return this.$root.alignments[this.match.id]}},methods:{validateMatch(){const t=this.validateField("sources",this.match.sources.length>0),e=this.validateField("targets",this.match.targets.length>0),s=this.validateField("sources_select",!this.$refs.sourceResourceComponents.map(t=>t.validateResource()).includes(!1)),i=this.validateField("targets_select",!this.$refs.targetResourceComponents.map(t=>t.validateResource()).includes(!1));let o=!0;return this.$refs.matchingMethodGroupComponent&&(o=this.$refs.matchingMethodGroupComponent.validateConditionsGroup()),t&&e&&s&&i&&o},addMatchCondition(t){t.conditions.push({method_name:"",method_value:{},sources:this.match.sources.reduce((t,e)=>{return t[e]=[{property:[e,""]}],t},{}),targets:this.match.targets.reduce((t,e)=>{return t[e]=[{property:[e,""]}],t},{})})},addMatchResource(t,e){e&&e.target.blur(),this.match[t].push("")},updateMatchResource(t,e,s){const i=e=>{e.conditions.forEach(e=>{this.$set(e[t],s,[{property:[s,""]}]),e.conditions&&i(e)})},o=this.match[t][e];this.$set(this.match[t],e,s),i(this.match),this.updateProperties(o,s)},deleteMatchResource(t,e){const s=e=>{e.conditions.forEach(e=>{this.$delete(e[t],i),e.conditions&&s(e)})},i=this.match[t][e];this.match[t].length<1&&this.addMatchResource(t),s(this.match),this.$delete(this.match[t],e),this.updateProperties(i)},updateProperties(t,e){const s=this.match.sources.find(e=>e===t),i=this.match.targets.find(e=>e===t),o=this.match.properties.findIndex(e=>e[0]===t);o>=0&&!s&&!i&&this.match.properties.splice(o,1),e&&!this.match.properties.find(t=>t[0]===e)&&this.match.properties.push([e,""])},scrollTo(t){this.$refs[t].$el.parentNode.scrollIntoView({behavior:"smooth",block:"start"})},async runAlignment(t=!1){if(!this.validateMatch())return;const e=await this.$root.runAlignment(this.match.id,t);"exists"===e.result&&confirm("This Alignment job already exists.\nDo you want to overwrite it with the current configuration?")&&await this.runAlignment(!0)}},mounted(){this.match.sources.length<1&&this.addMatchResource("sources"),this.match.targets.length<1&&this.addMatchResource("targets")}},_e=ve,fe=Object(u["a"])(_e,Dt,Bt,!1,null,null,null),ge=fe.exports,be=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("card",{attrs:{id:"links_"+t.match.id,type:"links",label:t.match.label,fillLabel:!1},on:{show:t.getLinks,hide:function(e){t.showData=!1}},scopedSlots:t._u([{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto"},[s("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"matches_info_"+t.match.id,expression:"'matches_info_' + match.id"}],staticClass:"btn btn-info btn-sm",attrs:{type:"button"}},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"matches_info_"+t.match.id,expression:"'matches_info_' + match.id"}],attrs:{name:"chevron-down",scale:"1"}}),t._v("\n        Show alignment\n      ")],1)]),s("div",{staticClass:"col-auto mr-auto"},[s("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"properties_"+t.match.id,expression:"'properties_' + match.id"}],staticClass:"btn btn-info btn-sm",attrs:{type:"button"}},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"properties_"+t.match.id,expression:"'properties_' + match.id"}],attrs:{name:"chevron-down",scale:"1"}}),t._v("\n        Select properties\n      ")],1)])]},proxy:!0},{key:"header",fn:function(){return[s("b-collapse",{attrs:{id:"matches_info_"+t.match.id,accordion:"matches-info-accordion"}},[s("match-info",{attrs:{match:t.match}})],1),s("b-collapse",{attrs:{id:"properties_"+t.match.id,accordion:"properties-accordion"}},[s("properties",{attrs:{properties:t.match.properties}})],1)]},proxy:!0}])},[t.showData&&t.hasProperties?s("virtual-list",{staticClass:"mt-4",attrs:{size:130,remain:5,item:t.item,pagemode:!0,itemcount:t.links.length,itemprops:t.getItemProps}}):t._e()],1)},ye=[],Ce=s("89c1"),we=s.n(Ce),xe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("sub-card",{staticClass:"match-info"},[s("p",{staticClass:"font-weight-bold mb-2"},[t._v("Matching")]),s("matching-method-group-info",{attrs:{matching_method_group:t.match,is_root:!0}})],1)},$e=[],ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.matching_method_group.conditions?s("div",{class:{"border shadow p-2":!t.is_root}},[t._l(t.matching_method_group.conditions,function(e,i){return[s("matching-method-group-info",{key:i,attrs:{matching_method_group:e}}),i<t.matching_method_group.conditions.length-1?s("p",{staticClass:"font-weight-bold my-2 text-info"},[t._v("\n      "+t._s(t.matching_method_group.type)+"\n    ")]):t._e()]})],2):t.matching_method_group.conditions?t._e():s("match-condition-info",{attrs:{condition:t.matching_method_group}})},je=[],Ie=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"border shadow p-2"},[t._l(t.condition.sources,function(e){return t._l(e,function(e){return s("div",{staticClass:"row m-0"},[s("property",{attrs:{property:e.property,"read-only":!0,small:!0}}),e.transformers?s("p",{staticClass:"font-weight-bold m-0"},[t._v("\n        with transformers "+t._s(e.transformers.join(", "))+"\n      ")]):t._e()],1)})}),s("p",{staticClass:"font-weight-bold m-0"},[t._v("against")]),t._l(t.condition.targets,function(e){return t._l(e,function(e){return s("div",{staticClass:"row m-0"},[s("property",{attrs:{property:e.property,"read-only":!0,small:!0}}),e.transformers?s("p",{staticClass:"font-weight-bold m-0"},[t._v("\n        with transformers\n        "),s("span",{staticClass:"text-info"},[t._v(t._s(e.transformers.join(", ")))])]):t._e()],1)})}),s("p",{staticClass:"font-weight-bold m-0"},[t._v("\n    using\n\n    "),s("span",{staticClass:"text-info"},[t._v(t._s(t.methodValueTemplate.label))]),t.methodValueTemplate.items.length>0?[t._v("\n      [ "),s("span",{domProps:{innerHTML:t._s(t.methodValuePropsHumanReadable)}}),t._v(" ]\n    ")]:t._e()],2)],2)},Se=[],Oe={name:"MatchConditionInfo",data(){return{transformers:de.transformers,matchingMethods:de.matchingMethods}},props:{condition:Object},computed:{methodValueTemplate(){return this.matchingMethods.hasOwnProperty(this.condition.method_name)?this.matchingMethods[this.condition.method_name]:{label:"",items:[]}},methodValuePropsHumanReadable(){return this.methodValueTemplate.items.map(t=>{let e=this.condition.method_value[t.key];return"IS_IN_SET"===this.condition.method_name?e=this.$root.matches.find(t=>t.id===e.value).label:t.choices&&(e=Object.keys(t.choices).find(s=>t.choices[s]===e)),t.label?`<span class="text-info">${t.label} = ${e}</span>`:`<span class="text-info">${e}</span>`}).join(" and ")}}},Re=Oe,Ae=Object(u["a"])(Re,Ie,Se,!1,null,null,null),Me=Ae.exports,Pe={name:"MatchingMethodGroupInfo",components:{MatchConditionInfo:Me},props:{is_root:{type:Boolean,default:!1},matching_method_group:{}}},Ee=Pe,Te=Object(u["a"])(Ee,ke,je,!1,null,null,null),Ne=Te.exports,Fe={name:"MatchInfo",components:{SubCard:wt,MatchingMethodGroupInfo:Ne},props:{match:Object}},Le=Fe,De=(s("7bc4"),Object(u["a"])(Le,xe,$e,!1,null,null,null)),Be=De.exports,Ge=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("sub-card",t._l(t.properties,function(e,i){return s("div",{staticClass:"row ml-4",class:{"mt-3":0===i}},[e[0]?s("property",{attrs:{property:e,singular:!0,"singular-resource-info":!0,"follow-referenced-collection":!1},on:{resetProperty:function(s){return t.resetProperty(i,e,s)}}}):t._e()],1)}),0)},Ve=[],ze={name:"Properties",components:{SubCard:wt},props:{properties:Array},methods:{resetProperty(t,e,s){const i=e.slice(0,s);i.push(""),i.length%2>0&&i.push(""),this.$set(this.properties,t,i)}}},Je=ze,Ue=Object(u["a"])(Je,Ge,Ve,!1,null,null,null),He=Ue.exports,We=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("sub-card",{attrs:{"small-spacing":!0,"is-first":t.isFirst}},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto"},[s("div",{staticClass:"text-center bg-info-light text-info border border-info rounded p-2"},[s("span",{staticClass:"font-weight-bold"},[t._v("Strength")]),s("br"),s("span",{staticClass:"font-italic"},[t._v(t._s(t.strength))])])]),s("div",{staticClass:"col"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("span",{staticClass:"font-weight-bold pr-1"},[t._v("Source:")]),s("span",{staticClass:"font-italic"},[t._v(t._s(t.source))])]),s("div",{staticClass:"col"},[s("span",{staticClass:"font-weight-bold pr-1"},[t._v("Target:")]),s("span",{staticClass:"font-italic"},[t._v(t._s(t.target))])])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},t._l(t.sourceProperties,function(t,e){return s("property",{key:e,attrs:{property:t.property,values:t.values,"read-only":!0}})}),1),s("div",{staticClass:"col"},t._l(t.targetProperties,function(t,e){return s("property",{key:e,attrs:{property:t.property,values:t.values,"read-only":!0}})}),1)])])])])},qe=[],Ye={name:"MatchLink",components:{SubCard:wt},props:{source:String,sourceValues:Array,target:String,targetValues:Array,strength:String,isFirst:Boolean},computed:{sourceProperties(){return this.sourceValues.map(t=>{return{property:[this.$root.getResourceByDatasetId(t.dataset).id,t.property],values:t.values}})},targetProperties(){return this.sourceValues.map(t=>{return{property:[this.$root.getResourceByDatasetId(t.dataset).id,t.property],values:t.values}})}}},Xe=Ye,Ze=Object(u["a"])(Xe,We,qe,!1,null,null,null),Ke=Ze.exports,Qe={name:"Links",components:{VirtualList:we.a,Card:_t,SubCard:wt,MatchInfo:Be,Properties:He,MatchLink:Ke},data(){return{links:[],properties:Object,showData:!1,item:Ke}},props:{match:Object},computed:{hasProperties(){return!this.match.properties.map(t=>""!==t[1]).includes(!1)}},methods:{async getLinks(){const t=this.$root.getTargetsForMatch(this.match.id);this.links=await this.$root.getAlignment(this.match.id),this.properties=await this.$root.getPropertiesForAlignment(this.match.id,t),this.showData=!0},getItemProps(t){const e=this.links[t];return{props:{source:e[0],sourceValues:this.properties[e[0]]||[],target:e[1],targetValues:this.properties[e[1]]||[],strength:e[2],isFirst:0===t}}}}},ts=Qe,es=Object(u["a"])(ts,be,ye,!1,null,null,null),ss=es.exports,is=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("card",{attrs:{id:"clusters_match_"+t.match.id,type:"clusters-matches",label:t.match.label,"fill-label":!1},on:{show:t.getClusters,hide:function(e){t.showData=!1}},scopedSlots:t._u([{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto"},[s("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"matches_info_"+t.match.id,expression:"'matches_info_' + match.id"}],staticClass:"btn btn-info btn-sm",attrs:{type:"button"}},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"matches_info_"+t.match.id,expression:"'matches_info_' + match.id"}],attrs:{name:"chevron-down",scale:"1"}}),t._v("\n        Show alignment\n      ")],1)]),s("div",{staticClass:"col-auto mr-auto"},[s("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"properties_"+t.match.id,expression:"'properties_' + match.id"}],staticClass:"btn btn-info btn-sm",attrs:{type:"button"}},[s("octicon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"properties_"+t.match.id,expression:"'properties_' + match.id"}],attrs:{name:"chevron-down",scale:"1"}}),t._v("\n        Select properties\n      ")],1)]),t.clustering?s("div",{staticClass:"col-auto"},[s("div",{staticClass:"h3 text-success"},[t._v("Clustered")])]):t._e(),s("div",{staticClass:"col-auto"},[t.clustering?s("button",{staticClass:"btn btn-info",attrs:{type:"button",disabled:""===t.association,title:""===t.association?"Choose an association first":""},on:{click:function(e){return t.createClustering(e)}}},[t._v("Reconcile\n      ")]):t._e(),t.clustering?t._e():s("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:function(e){return t.createClustering(e)}}},[t._v("Cluster\n        "),""!==t.association?[t._v(" & Reconcile")]:t._e()],2)]),t.associationFiles?s("div",{staticClass:"col-auto"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.association,expression:"association"}],staticClass:"form-control",attrs:{id:"match_"+t.match.id+"_association"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.association=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("No association")]),t._l(t.associationFiles,function(e){return s("option",{domProps:{value:e}},[t._v("\n          "+t._s(e)+"\n        ")])})],2)]):t._e()]},proxy:!0},{key:"header",fn:function(){return[s("b-collapse",{attrs:{id:"matches_info_"+t.match.id,accordion:"matches-info-accordion"}},[s("match-info",{attrs:{match:t.match}})],1),s("b-collapse",{attrs:{id:"properties_"+t.match.id,accordion:"properties-accordion"}},[s("properties",{attrs:{properties:t.match.properties}})],1),t.clustering?s("sub-card",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 font-weight-bold"},[t._v("\n              Clusters:\n            ")]),s("div",{staticClass:"col-6"},[t._v("\n              "+t._s(t.clustering.clusters_count)+"\n            ")])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 font-weight-bold"},[t._v("\n              Extended Clusters:\n            ")]),s("div",{staticClass:"col-6"},[t._v("\n              "+t._s(t.clustering.extended_count)+"\n            ")])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 font-weight-bold"},[t._v("\n              Clusters with Cycles:\n            ")]),s("div",{staticClass:"col-6"},[t._v("\n              "+t._s(t.clustering.cycles_count)+"\n            ")])])]),s("div",{staticClass:"col-5"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 font-weight-bold"},[t._v("\n              Clusters not Extended:\n            ")]),s("div",{staticClass:"col-6"},[t._v("\n              "+t._s(t.clustering.clusters_count-t.clustering.extended_count)+"\n            ")])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 font-weight-bold"},[t._v("\n              Clusters without Cycles:\n            ")]),s("div",{staticClass:"col-6"},[t._v("\n              "+t._s(t.clustering.clusters_count-t.clustering.cycles_count)+"\n            ")])])])])]):t._e()]},proxy:!0}])},[s("div",{staticClass:"bg-white border px-3 py-1 mt-4 mb-2"},[s("div",{staticClass:"row font-weight-bold"},[s("div",{staticClass:"col"},[t._v("Extended")]),s("div",{staticClass:"col"},[t._v("Reconciled")]),s("div",{staticClass:"col"},[t._v("Id")]),s("div",{staticClass:"col"},[t._v("Count")]),s("div",{staticClass:"col"},[t._v("Size")])])]),t.showData&&t.hasProperties?s("virtual-list",{attrs:{size:150,remain:5,item:t.item,itemcount:t.clustering.clusters_count,itemprops:t.getItemProps}}):t._e(),t.showData&&t.clusterIdSelected&&t.hasProperties?s("cluster-visualization",{attrs:{"clustering-id":t.clusteringId,"cluster-id":t.clusterIdSelected,"cluster-data":t.clusters[t.clusterIdSelected],properties:t.match.properties,association:t.association}}):t._e()],1)},os=[],rs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("sub-card",{class:t.selected?"bg-info-light":{},attrs:{"small-spacing":!0,"is-first":t.isFirst}},[s("div",{on:{click:function(e){return t.$emit("select:clusterId",t.clusterId)}}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col font-weight-bold",class:"ext_"+t.clusterData.extended},[t._v("\n        "+t._s(t.clusterData.extended)+"\n      ")]),s("div",{staticClass:"col font-weight-bold",class:"ext_"+t.clusterData.reconciled},[t._v("\n        "+t._s(t.clusterData.reconciled)+"\n      ")]),s("div",{staticClass:"col"},[t._v("\n        "+t._s(t.clusterId)+"\n      ")]),s("div",{staticClass:"col"},[t._v("\n        "+t._s(t.clusterData.index)+"\n      ")]),s("div",{staticClass:"col"},[t._v("\n        "+t._s(t.clusterData.nodes.length)+"\n      ")])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},t._l(t.props,function(t,e){return s("property",{key:e,attrs:{property:t.property,values:t.values,"read-only":!0}})}),1)])])])},as=[],ns={name:"Clustering",components:{SubCard:wt},props:{clusterId:String,clusterData:Object,properties:Object,selected:!1,isFirst:!1},computed:{resources(){const t=this.clusterData.links.flatMap(t=>t).map(t=>t.substring(1,t.length-1)),e=this.clusterData.nodes.map(t=>t.substring(1,t.length-1));return[...new Set(t.concat(e))]},props(){return Object.entries(this.properties).filter(([t,e])=>this.resources.includes(t)).slice(0,5).flatMap(([t,e])=>e).map(t=>{return{property:[this.$root.getResourceByDatasetId(t.dataset).id,t.property],values:t.values}})}}},ls=ns,cs=(s("13be"),Object(u["a"])(ls,rs,as,!1,null,null,null)),ds=cs.exports,us=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("sub-card",{attrs:{label:"Cluster","has-collapse":!0,"has-info":!0,"has-columns":!0,id:"cluster_plot_row_1",type:"cluster"},scopedSlots:t._u([{key:"info",fn:function(){return[s("cluster-visualization-info")]},proxy:!0},{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto ml-auto"},[t.association?s("button",{staticClass:"btn btn-info mr-4",attrs:{type:"button"},on:{click:function(e){return t.getGraphData("cluster")}}},[t._v("\n          Load Original Clusters\n        ")]):t._e()])]},proxy:!0}])},[s("svg",{staticClass:"plot mt-3",attrs:{visible:!Boolean(t.association),id:"graph_cluster_1"}})]),s("sub-card",{attrs:{label:"Compact Cluster","has-collapse":!0,"has-info":!0,"has-columns":!0,id:"cluster_plot_row_2",type:"cluster-compact"},scopedSlots:t._u([{key:"info",fn:function(){return[s("cluster-visualization-compact-info")]},proxy:!0},{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto ml-auto"},[t.association?s("button",{staticClass:"btn btn-info mr-4",attrs:{type:"button"},on:{click:function(e){return t.getGraphData("cluster")}}},[t._v("\n          Load Original Clusters\n        ")]):t._e()])]},proxy:!0}])},[s("svg",{staticClass:"plot mt-3",attrs:{visible:!Boolean(t.association),id:"graph_cluster_2"}})]),t.association?s("sub-card",{attrs:{label:"Reconciled","has-collapse":!0,"has-info":!0,"has-columns":!0,id:"cluster_plot_row_3",type:"cluster-compact"},scopedSlots:t._u([{key:"info",fn:function(){return[s("cluster-visualization-reconciled-info")]},proxy:!0},{key:"columns",fn:function(){return[s("div",{staticClass:"col-auto ml-auto"},[t.association?s("button",{staticClass:"btn btn-info mr-4",attrs:{type:"button"},on:{click:function(e){return t.getGraphData("cluster")}}},[t._v("\n          Load Original Clusters\n        ")]):t._e()])]},proxy:!0}],null,!1,3935740184)},[s("svg",{staticClass:"plot mt-3",attrs:{visible:!Boolean(t.association),id:"graph_cluster_3"}})]):t._e(),s("b-modal",{ref:"visualization_popup",attrs:{id:"visualization_popup",title:"CLUSTER DETAIL",size:"xl","hide-footer":"","return-focus":t.$root.$children[0].$el,static:!0}},[s("svg",{staticClass:"plot",attrs:{id:"graph_cluster_4"}})])],1)},ps=[],hs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"CLUSTER VISUALIZATION"}},[s("div",{staticClass:"text-left"},[s("div",{staticClass:"h2"},[t._v("Identity Link Network (ILN)")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      This provides additional information of Identity Link Clusters:\n    ")]),s("ul",{staticClass:"h5 ml-5"},[s("li",[t._v("Identity Link Clusters.")]),s("li",[t._v("Visualize a cluster and interact with it.")]),s("li",[t._v("An improved visualisation (particularly important for large clusters).")]),s("li",[t._v("Reconcile a cluster using additional information such relation.")])]),s("div",{staticClass:"h3 pt-4"},[t._v("An ILN of "),s("strong",[t._v("Meulder Hans")]),t._v(" in the Turtle Language")]),s("p",{staticClass:"h5 pt-4 pb-4 pl-5"},[t._v("\n      This is an example of links discovered using an approximate string similarity on\n      "),s("strong",[t._v("Ecartico")]),t._v(", "),s("strong",[t._v("Baptism")]),t._v(", "),s("strong",[t._v("Marriage")]),t._v(" and\n      "),s("strong",[t._v("Burial")]),t._v(" for married Amsterdammers between 1600 and 1650. These links are\n      specifically the ones that link different occurrences of "),s("strong",[t._v("Meulder Hans")]),t._v(".\n    ")]),s("textarea",{staticClass:"ml-5 mb-1",attrs:{disabled:"",cols:"75",rows:"18"}},[t._v("      @prefix baptism: <http://goldenagents.org/uva/SAA/person/IndexOpDoopregister/> .\n      @prefix ecartico: <http://www.vondel.humanities.uva.nl/ecartico/persons/> .\n      @prefix marriage: <http://goldenagents.org/uva/SAA/person/IndexOpOndertrouwregister/> .\n      @prefix owl: <http://www.w3.org/2002/07/owl#> .\n\n      baptism:saaId24678323p2 owl:sameAs ecartico:15747 .\n      baptism:saaId24678323p2 owl:sameAs marriage:saaId26379331p1 .\n      baptism:saaId24519437p2 owl:sameAs marriage:saaId26379331p1 .\n      baptism:saaId24285260p2 owl:sameAs baptism:saaId24519437p2 .\n      marriage:saaId26379331p1 owl:sameAs ecartico:15747 .\n      baptism:saaId24519437p2 owl:sameAs ecartico:15747 .\n      baptism:saaId24519437p2 owl:sameAs marriage:saaId26377774p1 .\n      baptism:saaId24285260p2 owl:sameAs ecartico:15747 .\n      baptism:saaId24285260p2 owl:sameAs marriage:saaId26379331p1 .\n      baptism:saaId24519437p2 owl:sameAs baptism:saaId24678323p2 .\n      marriage:saaId26377774p1 owl:sameAs ecartico:15747 .\n      marriage:saaId26377774p1 owl:sameAs marriage:saaId26379331p1 .\n      baptism:saaId24285260p2 owl:sameAs baptism:saaId24678323p2 .\n    ")]),s("div",{staticClass:"h3 pt-4"},[t._v("Visualizing an ILN of "),s("strong",[t._v("Meulder Hans")])]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      The cluster of "),s("strong",[t._v("Meulder Hans")]),t._v(" is composed of 6 nodes (potentially the same person)\n      using 13 link. The links in plain black represent an exact match (link strength = 1) while those in\n      dotted red represent a link of strength below 1. The color of the node depicts the data-source it is\n      stemmed from. So in this real example cluster,\n    ")]),s("ul",{staticClass:"h5 ml-5"},[s("li",[t._v("Three nodes are from "),s("strong",[t._v("Baptism")]),t._v(";")]),s("li",[t._v("Two nodes are from "),s("strong",[t._v("Marriage")]),t._v(" and;")]),s("li",[t._v("One is from "),s("strong",[t._v("Ecartico")]),t._v(".")])]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/1 Meulder Hans (Cluster).jpg",width:"700",height:"600"}})])])])},ms=[],vs={},_s=Object(u["a"])(vs,hs,ms,!1,null,null,null),fs=_s.exports,gs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"CLUSTER VISUALIZATION"}},[s("div",{staticClass:"text-left"},[s("div",{staticClass:"h3"},[t._v("A Compact Representation of Meulder Hans' ILN")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      The compact representation of a cluster allows for the display of large clusters and a comprehensive\n      aggravation of nodes. The approach groups nodes base on similar link strength starting from the\n      highest strength in the identity network. From the original cluster, two sub-groups of nodes can be\n      identified using the link strength of 1 (black plain link) together.\n    ")]),s("ul",{staticClass:"h5 ml-5"},[s("li",[t._v("Sub-group-1: Two nodes are linked with strength 1")]),s("li",[t._v("Sub-group-2: Three nodes are linked with strength 1")]),s("li",[t._v("Sub-group-3: One isolated node")])]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      The subgroups are then interconnected using an aggregated link represented by the highest strength.\n      Using such approach sub-groups and their interconnections are now clearly visible.\n    ")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      Each compact node contains 3 type of information:\n    ")]),s("ul",{staticClass:"h5 ml-5"},[s("li",[s("strong",[t._v("N")]),t._v(" indicating the number of nodes aggregated by the compact node.")]),s("li",[s("strong",[t._v("L")]),t._v(" indicating the number of links.")]),s("li",[s("strong",[t._v("S")]),t._v(" indicating the strength of the links that enabled the aggregation.")]),s("li",[t._v("The last information (not present in this example but visible in the second compact example of\n        size 35) removes a percentage of the node's color to indicate the number of missing links for the\n        number of nodes aggregated\n      ")])]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/1 Meulder Hans (Cluster).jpg",width:"700"}}),s("p",{staticClass:"h5 pt-4 pl-5 font-weight-bold"},[t._v("\n        Original Cluster\n      ")])]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/2 Meulder Hans (Cluster-Compact).jpg",width:"700"}}),s("p",{staticClass:"h5 pt-4 pl-5 font-weight-bold"},[t._v("\n        Compact Cluster\n      ")])]),s("div",{staticClass:"h3 pt-4"},[t._v("Large ILN Versus its Compact Version")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      This is an example of a bigger cluster of size 35 potentially representing "),s("strong",[t._v("Pieterss\n      Grietje")]),t._v(". The larger an ILN gets, the less comprehensive it is visually. Especially when it\n      highlight a mesh topology. For this very reason, the compact version of the visual ILN is of\n      importance for visual aid for validation purposes.\n    ")]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/1  Pieters Grietje (Cluster).jpg",width:"800"}})]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      This is the compact version of a cluster of size 35 potentially representing "),s("strong",[t._v("Pieterss\n      Grietje")]),t._v(". In this examople, 35 nodes are now converted into 4 compact nodes of size 25, 3, 2\n      and two. The last two nodes are of size one. The compact node of size 25 is composed of 294 limks\n      insted of 300. Meaning 6 links are missing.\n    ")]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/2  Pieters Grietje (Cluster-Compact).jpg",width:"800"}})]),s("div",{staticClass:"h3 pt-5"},[t._v("Expanding a Compact Node with Double-Click")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      For a better validation experience, each of the compact nodes can be expanded. This allows a\n      detailed understanding on the type of network (START - LINE - MESH) that defines the aggragated\n      node. When a compact node (sub-cluster) is double-clicked, for example the one of size 3, it is\n      highlighted in red as shown in on the left side the figure below, and its expanded version is\n      ploted, as shown in the right side of the figure.\n    ")]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/3 Meulder Hans (Cluster-Compact Selected).jpg",width:"1000"}})])])])},bs=[],ys={},Cs=Object(u["a"])(ys,gs,bs,!1,null,null,null),ws=Cs.exports,xs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button-info",{attrs:{popup_title:"RECONCILED CLUSTER VISUALIZATION"}},[s("div",{staticClass:"text-left"},[s("div",{staticClass:"h2"},[t._v("Reconciling an ILN")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      We enable the reconciliation of an ILN using relations between discovered ILN. For the current\n      example, the relation used is the marital status meaning married people. In this example, the ILN to\n      reconcile is the one of "),s("strong",[t._v("Meulder Hans")]),t._v(". It is the one in "),s("strong",[t._v("blue")]),t._v(" and it\n      connect to two other clusters using purple dotted lines. Reading the graph, the other two clusters\n      indicate that "),s("strong",[t._v("Meulder Hans")]),t._v(" appears to be connected to two women: **Petsinck\n      Catharina (orange)"),s("strong",[t._v(" and ")]),t._v("Jans Fijtje (green)**.\n    ")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      We provide two representation where the first picture presents a compact representation of all\n      clusters while the second representation presents a non compact representation of the investigated\n      cluster: "),s("strong",[t._v("Meulder Hans")]),t._v(".\n    ")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      Now, given this additional marital status, is it plausible that all nodes representing "),s("strong",[t._v("Meulder\n      Hans")]),t._v(" are indeed representing the same person?\n    ")]),s("p",{staticClass:"h5 pt-4 pl-5"},[t._v("\n      To answer this questions, we make use of the existence of "),s("strong",[t._v("cycle")]),t._v(" to materialise\n      strong evidence.\n    ")]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/4 Meulder Hans (Cluster-Compact Compact-Evidence).jpg",width:"900"}})]),s("div",{staticClass:"text-center pt-4"},[s("img",{attrs:{src:"/static/images/5 Meulder Hans (Cluster-Compact Evidence).jpg",width:"900"}})]),s("div",{staticClass:"h2 pt-4"},[t._v("Reconciled Nodes")])])])},$s=[],ks={},js=Object(u["a"])(ks,xs,$s,!1,null,null,null),Is=js.exports,Ss=s("5698");function Os(t,e,s,i){var o,r,a,n=Math.PI,l=20,c=null,d=Ss["h"](Ss["i"]),u=Ss["j"](s),p=Ss["j"](i),h=b(u),m=Ss["j"]("body").append("div").attr("class","tooltip").style("opacity",0);function v(t){return 16*Math.log2(t+1)}function _(t){return Ss["a"]().innerRadius(0).outerRadius(function(t){return t.nodes?.7*v(t.nodes):t.size?0:void 0}).startAngle(0).endAngle(function(t){return t.missing_links?-t.missing_links*n*2:0})}function f(t,e,s){t.selectAll("g").remove();var i=null,a=null,n=t.node().getBoundingClientRect();function c(){i.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),a.attr("cx",function(t){return t.x=Math.max(10,Math.min(n.width-200,t.x))}).attr("cy",function(t){return t.y=Math.max(10,Math.min(n.height-10,t.y))}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}i=t.append("g").attr("class","links").selectAll("line").data(e.links).enter().append("line").style("stroke-width",function(t){return Math.sqrt(t.value)+1}).style("stroke",function(t){return t.strength<1?"red":t.color?t.color:"black"}).style("stroke-dasharray",function(t){if(t.dash)return t.dash;var e=String(20*(1-t.strenght));return"3,"+e}).on("mouseover.tooltip",function(t){m.transition().duration(300).style("opacity",.8),m.html(function(){var e="";return t.strength&&(e="&nbsp Strength: "+t.strength+"&nbsp<br>"),t.count&&(e+="&nbsp Links: "+t.count+"&nbsp"),e}).style("left",Ss["c"].pageX+"px").style("top",Ss["c"].pageY+10+"px")}).on("mouseout.tooltip",function(){m.transition().duration(100).style("opacity",0)}),i.exit().remove(),a=t.append("g").attr("class","nodes").selectAll("g").data(e.nodes).enter().append("g"),a.append("circle").attr("r",function(t){return t.investigated&&"false"==String(t.investigated)?0:t.nodes?v(t.nodes)+2:t.size>5?1.2*t.size:0}).attr("fill","white").style("stroke",function(t){return o&&t===o?"red":r&&t===r?"red":"black"}).style("stroke-width",4).style("stroke-dasharray",function(t){return t.satellite?"10,3":"10,0"}),a.append("circle").attr("r",function(t){return t.nodes?v(t.nodes):t.size?t.size:5}).attr("fill",function(t){return o&&t===o?"red":d(t.group)}).on("dblclick",y).style("stroke",function(t){return t.investigated&&"true"==String(t.investigated)?"white":t.nodes?"black":t.size>5?"white":"black"}).style("stroke-width",2).call(Ss["b"]().on("start",C).on("drag",w).on("end",x)),a.append("path").attr("d",_(l)).attr("fill","white"),a.append("text").text(function(t){return t.label?t.label:t.id}).attr("x",function(t){return t.nodes?.9*v(t.nodes)+8:t.size?.9*t.size+8:void 0}).attr("y",3),a.append("svg:text").attr("dx",function(t){return t.nodes&&t.nodes>2?-v(t.nodes)/3:-10}).attr("dy",3).text(function(t){if(t.nodes)return"N:"+t.nodes}).style("font-weight","bold"),a.append("svg:text").attr("dx",function(t){if(t.nodes&&t.nodes>2){var e=t.nodes*(t.nodes-1)/2;return t.missing_links>0?"L:"+Math.round(e*(1-t.missing_links))+"/"+e:"L:"+e,-v(t.nodes)/3}}).attr("dy",15).text(function(t){if(t.nodes&&t.nodes>2){var e=t.nodes*(t.nodes-1)/2;return t.missing_links>0?"L:"+Math.round(e*(1-t.missing_links))+"/"+e:"L:"+e}}),a.append("svg:text").attr("dx",-8).attr("dy",function(t){if(t.nodes)return v(t.nodes)+13}).text(function(t){if(t.strength&&t.nodes&&t.nodes>1)return Number.parseFloat(String(t.strength))?"S:"+Math.round(1e3*t.strength)/1e3:"S:"+t.strength}).style("font-weight","bold"),a.append("title").text(function(t){return t.id}),a.exit().remove(),s.nodes(e.nodes).on("tick",c),s.force("link").links(e.links)}function g(e){c=e,Rs(p),t.$on("shown",()=>{a=b(p),f(p,e,a)}),t.show()}function b(t){var e=t.node().getBoundingClientRect(),s=Ss["g"]().force("link",Ss["e"]().id(function(t){return t.id}).distance(function(t){return t.dist_factor?v(t.dist_factor[0])+v(t.dist_factor[1])+.8*t.distance:t.distance})).force("charge",Ss["f"]()).force("center",Ss["d"](e.width/2,e.height/2));return s}function y(t){o=t,t.child?("graph_cluster_parent"==this.farthestViewportElement.id?f(u,e,h):"graph_cluster_child"==this.farthestViewportElement.id&&f(p,c,a),g(t.child)):"graph_cluster_parent"==this.farthestViewportElement.id?f(u,e,h):"graph_cluster_child"==this.farthestViewportElement.id&&f(p,c,a)}function C(t){Ss["c"].active||("graph_cluster_parent"==this.farthestViewportElement.id?h.alphaTarget(.2).restart(e):"graph_cluster_child"==this.farthestViewportElement.id&&a.alphaTarget(.2).restart(c)),t.fx=t.x,t.fy=t.y}function w(t){t.fx=Ss["c"].x,t.fy=Ss["c"].y}function x(t){Ss["c"].active||("graph_cluster_parent"==this.farthestViewportElement.id?h.alphaTarget(0):"graph_cluster_child"==this.farthestViewportElement.id&&a.alphaTarget(0))}f(u,e,h)}function Rs(t){t="string"===typeof t?Ss["j"](t):t,t.selectAll("*").remove()}var As={name:"ClusterVisualization",components:{SubCard:wt,ClusterVisualizationInfo:fs,ClusterVisualizationCompactInfo:ws,ClusterVisualizationReconciledInfo:Is},props:{properties:Array,clusterData:Object,clusterId:String,clusteringId:String,association:String},methods:{getGraphLink(){return`/job/${this.$root.job.job_id}/cluster/${this.clusteringId}/${this.clusterId}`},draw(t,e){Os(this.$refs["visualization_popup"],t,e,"svg#graph_cluster_4")},async getGraphData(t){Rs("graph_cluster_1"),Rs("graph_cluster_2"),Rs("graph_cluster_3");const e=this.properties.map(t=>{const e=this.$root.getResourceById(t[0]);return{dataset:e.dataset_id,entity_type:e.collection_id,property:t[1]}}),s=await this.$root.getClusterGraphs(this.clusteringId,this.clusterId,{cluster_data:this.clusterData,properties:e,get_cluster:!Boolean(this.association)||"cluster"===t,get_reconciliation:"yes"===this.clusterData.extended,associations:"yes"===this.clusterData.extended?this.association:""});s.cluster_graph&&this.draw(s.cluster_graph,"svg#graph_cluster_1"),s.cluster_graph_compact&&this.draw(s.cluster_graph_compact,"svg#graph_cluster_2"),s.reconciliation_graph&&this.draw(s.reconciliation_graph,"svg#graph_cluster_3")}},mounted(){this.clusterId&&this.getGraphData()},watch:{clusterId(){this.getGraphData()}}},Ms=As,Ps=(s("2f61"),Object(u["a"])(Ms,us,ps,!1,null,"509aa404",null)),Es=Ps.exports,Ts={name:"Cluster",components:{VirtualList:we.a,Card:_t,SubCard:wt,MatchInfo:Be,Properties:He,Clustering:ds,ClusterVisualization:Es},data(){return{clusters:{},clusteringId:null,clusterIdSelected:null,association:"",properties:Object,item:ds,showData:!1,associationFiles:[]}},props:{match:Object},computed:{clusterIds(){return Object.keys(this.clusters)},hasProperties(){return!this.match.properties.map(t=>""!==t[1]).includes(!1)},clustering(){return this.$root.clusterings.find(t=>t.alignment===this.match.id)},resources(){const t=Object.values(this.clusters).flatMap(t=>t.links).flatMap(t=>t).map(t=>t.substring(1,t.length-1)),e=Object.values(this.clusters).flatMap(t=>t.nodes).map(t=>t.substring(1,t.length-1));return[...new Set(t.concat(e))]}},methods:{async createClustering(t){if(t){let e=t.target;e.setAttribute("disabled","disabled")}const e=this.clustering?this.association:"";await this.$root.createClustering(this.match.id,e,this.clustering),!this.clustering&&this.association?this.createClustering(this.match.id):this.$emit("reload")},async getClusters(){if(this.clustering){this.clusteringId=this.clustering.clustering_id;const t=this.$root.getTargetsForMatch(this.match.id);this.clusters=await this.$root.getClusters(this.clusteringId,this.association),this.properties=await this.$root.getProperties(this.resources,t),this.showData=!0}},getItemProps(t){const e=this.clusterIds[t];return{props:{clusterId:e,clusterData:this.clusters[e],properties:this.properties,selected:this.clusterIdSelected===e,isFirst:0===t},on:{"select:clusterId":t=>this.clusterIdSelected=t}}}},async mounted(){this.associationFiles=await this.$root.getAssociationFiles()}},Ns=Ts,Fs=Object(u["a"])(Ns,is,os,!1,null,null,null),Ls=Fs.exports,Ds=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"row align-items-center justify-content-between"},[s("div",{staticClass:"col-auto"},[s("h2",[t._v(t._s(t.title))])]),t._t("header")],2),t._t("default"),s("b-alert",{staticClass:"mt-4 mb-0",attrs:{show:t.is_saved&&""!==t.tab_error,variant:"warning"}},[t._v("\n    Successfully saved, but with errors:\n    "+t._s(t.tab_error)+"\n  ")]),s("b-alert",{staticClass:"mt-4 mb-0",attrs:{show:!t.is_saved&&""!==t.tab_error,variant:"danger"}},[t._v("\n    "+t._s(t.tab_error)+"\n  ")])],2)},Bs=[],Gs={name:"TabContentStructure",props:{title:String,tab_error:String,is_saved:Boolean}},Vs=Gs,zs=Object(u["a"])(Vs,Ds,Bs,!1,null,null,null),Js=zs.exports,Us={name:"App",mixins:[z],components:{TabContentStructure:Js,Idea:lt,Resource:Lt,Match:ge,Links:ss,Cluster:Ls},data(){return{tab_error:"",idea_form:"",id_to_load:"",job_id:"",job_title:"",job_description:"",is_saved:!0,is_updating:!1,steps:["idea","collections","alignments","link_validation","clusters","cluster_validation"]}},computed:{hasChanges(){return!Boolean(this.$root.job)||JSON.stringify(this.$root.resources)!==JSON.stringify(this.$root.job["resources_form_data"])||JSON.stringify(this.$root.matches)!==JSON.stringify(this.$root.job["mappings_form_data"])}},methods:{isTabValid(t,e,s){return this.tab_error=t?"":s,this.is_saved=e,!!t},validateIdeaTab(){return this.isTabValid(this.$root.job,!1,"Please update or create your idea first!")},validateCollectionsTab(t=!1){const e=this.$refs.resourceComponents.map(t=>t.validateResource()),s=e.includes(!1)?this.isTabValid(!1,t,"One or more resources contain errors!"):this.isTabValid(this.$root.resources.length>0,!1,"Please add at least one resource!");return(s||t)&&this.submit(),s},validateAlignmentsTab(t=!1){const e=this.$refs.matchComponents.map(t=>t.validateMatch()),s=e.includes(!1)?this.isTabValid(!1,t,"One or more alignments contain errors!"):this.isTabValid(this.$root.matches.length>0,!1,"Please add at least one alignment!");return(s||t)&&this.submit(),s},validateAndSave(t){switch(t){case 1:return this.validateCollectionsTab(!0);case 2:return this.validateAlignmentsTab(!0);default:return!1}},activateStep(t,e=!1){let s=this.steps.indexOf(t);if(s<0||"undefined"===typeof this.$refs["formWizard"].tabs[s])return!1;for(let i=0;i<=s;i++)this.$set(this.$refs["formWizard"].tabs[i],"checked",!0);this.$set(this.$refs["formWizard"],"maxStep",s),e&&this.$refs["formWizard"].changeTab(this.$refs["formWizard"].activeTabIndex,s)},addResource(t){t&&t.target.blur(),this.$root.addResource()},addMatch(t){t&&t.target.blur(),this.$root.addMatch()},duplicateMatch(t){this.$root.duplicateMatch(t)},async createJob(t){const e=await this.$root.createJob(t);this.setJobId(e)},async updateJob(t){this.is_updating=!0,await this.$root.updateJob(t),await this.getJobData(),this.is_updating=!1},async setJobId(t){this.$set(this,"job_id",t);let e=new URL(window.location.href);e.searchParams.set("job_id",t),window.history.pushState(null,null,e.href),await this.getJobData()},async submit(){await this.$root.submit(),await this.getJobData()},async getJobData(){""!==this.job_id&&(await this.$root.loadJob(this.job_id),this.$root.job&&(this.job_title=this.$root.job.job_title,this.job_description=this.$root.job.job_description,this.activateStep("collections"),0===this.$root.resources.length&&this.$root.addResource(),0===this.$root.matches.length?this.$root.addMatch():this.activateStep("alignments"),this.refreshAlignments()))},refreshAlignments(){let t=!1,e=!1;Object.keys(this.$root.alignments).forEach(s=>{const i=this.$root.alignments[s];"Finished"===i.status?t=!0:i.status.startsWith("FAILED")||(e=!0)}),t&&this.activateStep("clusters"),e&&setTimeout(()=>this.$root.loadAlignments().then(()=>this.refreshAlignments()),5e3)}},async mounted(){await this.$root.loadDatasets();const t=new URLSearchParams(window.location.search),e=t.get("job_id");e&&(this.job_id=e,this.idea_form="existing",this.getJobData())}},Hs=Us,Ws=Object(u["a"])(Hs,et,st,!1,null,null,null),qs=Ws.exports,Ys=s("369b"),Xs=s.n(Ys),Zs={data(){return{job:null,alignments:[],clusterings:[],resources:[],matches:[],datasets:null}},methods:{addResource(){this.resources.push({dataset_id:"",collection_id:"",id:ti(this.resources),filter:{type:"AND",conditions:[]},limit:-1,related:[],related_array:!1})},addMatch(){this.matches.push({id:ti(this.matches),is_association:!1,label:"Alignment "+(this.matches.length+1),sources:[],targets:[],properties:[],type:"AND",conditions:[]})},duplicateMatch(t){const e=Ks(t);this.matches.push({...e,id:ti(this.matches),label:"Alignment "+(this.matches.length+1)})},getResourceById(t,e=this.resources){return e.find(e=>Qs(t)&&e.id===parseInt(t)||e.label===t)},getResourceByDatasetId(t,e=this.resources){return e.find(e=>e.dataset_id===t)},getMatchById(t,e=this.matches){return e.find(e=>Qs(t)&&e.id===parseInt(t)||e.label===t)},getTargetsForMatch(t){const e=this.getMatchById(t);return e.properties.reduce((t,e)=>{const s=this.getResourceById(e[0]);let i=t.find(t=>t.graph===s.dataset_id);return i||(i={graph:s.dataset_id,data:[]},t.push(i)),i.data.push({entity_type:s.collection_id,properties:[e[1]]}),t},[])},createReferencesForProperty(t,e){const s=this.getResourceById(t[0],e);if(t[0]=s.label,t.length<3)return t;if("__value__"===t[2])return t.slice(0,2);const i={label:this.$utilities.md5(t[0]+t[1]+t[2]),collection_id:t[2],dataset_id:s.dataset_id,related:[]};e.find(t=>t.label===i.label)||e.push(i);const o={resource:i.label,local_property:t[1],remote_property:"uri"};s.related.find(t=>JSON.stringify(t)===JSON.stringify(o))||s.related.push(o),s.related.length>1&&(s.related_array=!0);const r=[i.label,t[3],...t.slice(4)];return this.createReferencesForProperty(r,e)},async submit(){const t=Ks(this.resources),e=Ks(this.matches);e.forEach(e=>{["sources","targets"].forEach(t=>{e[t].forEach((s,i)=>{Qs(s)&&(e[t][i]=this.getResourceById(s).label)})}),ei(e.conditions).forEach(e=>{["sources","targets"].forEach(s=>{Object.keys(e[s]).forEach(i=>{e[s][i].forEach((o,r)=>{e[s][i][r].property=this.createReferencesForProperty(o.property,t)}),e[s][this.getResourceById(i).label]=e[s][i],delete e[s][i]})})}),delete e.properties}),t.forEach(e=>{e.filter&&e.filter.conditions&&e.filter.conditions.length>0?ei(e.filter.conditions).forEach(e=>{e.property=this.createReferencesForProperty(e.property,t)}):delete e.filter,e.related&&(e.related.forEach(t=>{Qs(t.resource)&&(t.resource=this.getResourceById(t.resource).label),t.local_property=[t.local_property],t.remote_property=[t.remote_property]}),e.related_array&&(e.related=[e.related])),delete e.related_array,delete e.id}),await this.updateJob({job_id:this.job.job_id,job_title:this.job.job_title,job_description:this.job.job_description,resources:t,matches:e,resources_original:this.resources,matches_original:this.matches,status:"Requested"})},async loadJob(t){this.job=await si("/job/"+t),this.job.resources_form_data&&(this.resources=Ks(this.job.resources_form_data)),this.job.mappings_form_data&&(this.matches=Ks(this.job.mappings_form_data)),await Promise.all([this.loadAlignments(),this.loadClusterings()])},async loadAlignments(){this.alignments=await si(`/job/${this.job.job_id}/alignments`)},async loadClusterings(){this.clusterings=await si(`/job/${this.job.job_id}/clusterings`)},async createJob(t){const e=await si("/job/create/",t);return e.job_id},async updateJob(t){await si("/job/update/",t)},async runAlignment(t,e){return await this.submit(),si(`/job/${this.job.job_id}/run_alignment/${t}`,{restart:e})},async getAlignment(t){return ii(`/job/${this.job.job_id}/alignment/${t}`)},async getPropertiesForAlignment(t,e){return si(`/job/${this.job.job_id}/alignment/${t}/properties`,{targets:e})},async getClusters(t,e){return si(`/job/${this.job.job_id}/clusters/${t}?association=${e}`)},async createClustering(t,e,s){return si(`/job/${this.job.job_id}/create_clustering/`,{alignment:t,association_file:e,clustered:s})},async getClusterGraphs(t,e,s){return si(`/job/${this.job.job_id}/cluster/${t}/${e}/graph`,s)},async getAssociationFiles(){return si("/association_files")},async getProperties(t,e){return si("/properties",{resources:t,targets:e})},async loadDatasets(){if(this.datasets)return;const t=await si("/datasets");Object.keys(t).forEach(e=>{const s=t[e];Object.keys(s.collections).forEach(t=>{const e=s.collections[t];Object.keys(e).forEach(t=>{const i=e[t];if(i.hasOwnProperty("referencedCollections")){const t=i.referencedCollections;i.referencedCollections={},t.filter(t=>"tim_unknown"!==t).forEach(t=>i.referencedCollections[t]=s.collections[t])}})})}),this.datasets=t}}};function Ks(t){return JSON.parse(JSON.stringify(t))}function Qs(t){return Number.isInteger(t)||/^\d+$/.test(t)}function ti(t){let e=-1;return t.forEach(t=>{t.id>e&&(e=t.id)}),e+1}function ei(t){let e;return Array.isArray(t)?e=t:Array.isArray(t.conditions)&&(e=t.conditions),e?e.reduce((t,e)=>t.concat(ei(e)),[]):[t]}async function si(t,e){if(e){const s=await fetch(t,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)});return s.json()}const s=await fetch(t);return s.json()}function ii(t){return new Promise((e,s)=>{Xs.a.parse(t,{download:!0,fastMode:!0,delimiter:",",complete:t=>e(t.data),error:t=>s(t)})})}s("a89b"),s("da93");i["default"].use(o["a"]),i["default"].use(a.a),i["default"].component("edit-label",h),i["default"].component("button-add",b),i["default"].component("button-delete",k),i["default"].component("button-info",M),i["default"].component("v-select",L),i["default"].component("property",Z),i["default"].component("octicon",K["a"]),i["default"].prototype.$utilities={md5:tt.a,getOrCreate(t,e,s,i){return"undefined"===typeof e[s]&&t(e,s,i),e[s]}},i["default"].filter("capitalize",function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}),new i["default"]({mixins:[Zs],render:t=>t(qs)}).$mount("#app")},"7bc4":function(t,e,s){"use strict";var i=s("f306"),o=s.n(i);o.a},a89b:function(t,e,s){},bd33:function(t,e,s){},e422:function(t,e,s){},e722:function(t,e,s){},f306:function(t,e,s){}});
//# sourceMappingURL=app.21013e31.js.map